/* CodeMirror - Minified & Bundled
   Generated on 2016/5/27 with http://codemirror.net/doc/compress.html
   Version: HEAD

   Keymaps:
   - emacs.js
   - sublime.js
   - vim.js
 */

!function(a){"object"==typeof exports&&"object"==typeof module?a(require("../lib/codemirror")):"function"==typeof define&&define.amd?define(["../lib/codemirror"],a):a(CodeMirror)}(function(a){"use strict";function c(a,b){return a.line==b.line&&a.ch==b.ch}function e(a){d.push(a),d.length>50&&d.shift()}function f(a){return d.length?void(d[d.length-1]+=a):e(a)}function g(a){return d[d.length-(a?Math.min(a,1):1)]||""}function h(){return d.length>1&&d.pop(),g()}function j(a,b,d,g,h){null==h&&(h=a.getRange(b,d)),g&&i&&i.cm==a&&c(b,i.pos)&&a.isClean(i.gen)?f(h):e(h),a.replaceRange("",b,d,"+delete"),i=g?{cm:a,pos:b,gen:a.changeGeneration()}:null}function k(a,b,c){return a.findPosH(b,c,"char",!0)}function l(a,b,c){return a.findPosH(b,c,"word",!0)}function m(a,b,c){return a.findPosV(b,c,"line",a.doc.sel.goalColumn)}function n(a,b,c){return a.findPosV(b,c,"page",a.doc.sel.goalColumn)}function o(a,c,d){for(var e=c.line,f=a.getLine(e),g=/\S/.test(0>d?f.slice(0,c.ch):f.slice(c.ch)),h=a.firstLine(),i=a.lastLine();;){if(e+=d,h>e||e>i)return a.clipPos(b(e-d,0>d?0:null));f=a.getLine(e);var j=/\S/.test(f);if(j)g=!0;else if(g)return b(e,0)}}function p(a,c,d){for(var e=c.line,f=c.ch,g=a.getLine(c.line),h=!1;;){var i=g.charAt(f+(0>d?-1:0));if(i){if(h&&/[!?.]/.test(i))return b(e,f+(d>0?1:0));h||(h=/\w/.test(i)),f+=d}else{if(e==(0>d?a.firstLine():a.lastLine()))return b(e,f);if(g=a.getLine(e+d),!/\S/.test(g))return b(e,f);e+=d,f=0>d?g.length:0}}}function q(a,d,e){var f;if(a.findMatchingBracket&&(f=a.findMatchingBracket(d,!0))&&f.match&&(f.forward?1:-1)==e)return e>0?b(f.to.line,f.to.ch+1):f.to;for(var g=!0;;g=!1){var h=a.getTokenAt(d),i=b(d.line,0>e?h.start:h.end);if(!(g&&e>0&&h.end==d.ch)&&/\w/.test(h.string))return i;var j=a.findPosH(i,e,"char");if(c(i,j))return d;d=j}}function r(a,b){var c=a.state.emacsPrefix;return c?(A(a),"-"==c?-1:Number(c)):b?null:1}function s(a){var b="string"==typeof a?function(b){b.execCommand(a)}:a;return function(a){var c=r(a);b(a);for(var d=1;c>d;++d)b(a)}}function t(a,b,d,e){var f=r(a);0>f&&(e=-e,f=-f);for(var g=0;f>g;++g){var h=d(a,b,e);if(c(h,b))break;b=h}return b}function u(a,b){var c=function(c){c.extendSelection(t(c,c.getCursor(),a,b))};return c.motion=!0,c}function v(a,b,c){for(var e,d=a.listSelections(),f=d.length;f--;)e=d[f].head,j(a,e,t(a,e,b,c),!0)}function w(a){if(a.somethingSelected()){for(var c,b=a.listSelections(),d=b.length;d--;)c=b[d],j(a,c.anchor,c.head);return!0}}function x(a,b){return a.state.emacsPrefix?void("-"!=b&&(a.state.emacsPrefix+=b)):(a.state.emacsPrefix=b,a.on("keyHandled",z),void a.on("inputRead",B))}function z(a,b){a.state.emacsPrefixMap||y.hasOwnProperty(b)||A(a)}function A(a){a.state.emacsPrefix=null,a.off("keyHandled",z),a.off("inputRead",B)}function B(a,b){var c=r(a);if(c>1&&"+input"==b.origin){for(var d=b.text.join("\n"),e="",f=1;c>f;++f)e+=d;a.replaceSelection(e)}}function C(a){a.state.emacsPrefixMap=!0,a.addKeyMap(L),a.on("keyHandled",D),a.on("inputRead",D)}function D(a,b){("string"!=typeof b||!/^\d$/.test(b)&&"Ctrl-U"!=b)&&(a.removeKeyMap(L),a.state.emacsPrefixMap=!1,a.off("keyHandled",D),a.off("inputRead",D))}function E(a){a.setCursor(a.getCursor()),a.setExtending(!a.getExtending()),a.on("change",function(){a.setExtending(!1)})}function F(a){a.setExtending(!1),a.setCursor(a.getCursor())}function G(a,b,c){a.openDialog?a.openDialog(b+': <input type="text" style="width: 10em"/>',c,{bottom:!0}):c(prompt(b,""))}function H(a,b){var c=a.getCursor(),d=a.findPosH(c,1,"word");a.replaceRange(b(a.getRange(c,d)),c,d),a.setCursor(d)}function I(a){for(var c=a.getCursor(),d=c.line,e=c.ch,f=[];d>=a.firstLine();){for(var g=a.getLine(d),h=null==e?g.length:e;h>0;){var e=g.charAt(--h);if(")"==e)f.push("(");else if("]"==e)f.push("[");else if("}"==e)f.push("{");else if(/[\(\{\[]/.test(e)&&(!f.length||f.pop()!=e))return a.extendSelection(b(d,h))}--d,e=null}}function J(a){a.execCommand("clearSearch"),F(a)}function M(a){L[a]=function(b){x(b,a)},K["Ctrl-"+a]=function(b){x(b,a)},y["Ctrl-"+a]=!0}for(var b=a.Pos,d=[],i=null,y={"Alt-G":!0,"Ctrl-X":!0,"Ctrl-Q":!0,"Ctrl-U":!0},K=a.keyMap.emacs=a.normalizeKeyMap({"Ctrl-W":function(a){j(a,a.getCursor("start"),a.getCursor("end"))},"Ctrl-K":s(function(a){var c=a.getCursor(),d=a.clipPos(b(c.line)),e=a.getRange(c,d);/\S/.test(e)||(e+="\n",d=b(c.line+1,0)),j(a,c,d,!0,e)}),"Alt-W":function(a){e(a.getSelection()),F(a)},"Ctrl-Y":function(a){var b=a.getCursor();a.replaceRange(g(r(a)),b,b,"paste"),a.setSelection(b,a.getCursor())},"Alt-Y":function(a){a.replaceSelection(h(),"around","paste")},"Ctrl-Space":E,"Ctrl-Shift-2":E,"Ctrl-F":u(k,1),"Ctrl-B":u(k,-1),Right:u(k,1),Left:u(k,-1),"Ctrl-D":function(a){v(a,k,1)},Delete:function(a){w(a)||v(a,k,1)},"Ctrl-H":function(a){v(a,k,-1)},Backspace:function(a){w(a)||v(a,k,-1)},"Alt-F":u(l,1),"Alt-B":u(l,-1),"Alt-D":function(a){v(a,l,1)},"Alt-Backspace":function(a){v(a,l,-1)},"Ctrl-N":u(m,1),"Ctrl-P":u(m,-1),Down:u(m,1),Up:u(m,-1),"Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd",End:"goLineEnd",Home:"goLineStart","Alt-V":u(n,-1),"Ctrl-V":u(n,1),PageUp:u(n,-1),PageDown:u(n,1),"Ctrl-Up":u(o,-1),"Ctrl-Down":u(o,1),"Alt-A":u(p,-1),"Alt-E":u(p,1),"Alt-K":function(a){v(a,p,1)},"Ctrl-Alt-K":function(a){v(a,q,1)},"Ctrl-Alt-Backspace":function(a){v(a,q,-1)},"Ctrl-Alt-F":u(q,1),"Ctrl-Alt-B":u(q,-1),"Shift-Ctrl-Alt-2":function(a){var b=a.getCursor();a.setSelection(t(a,b,q,1),b)},"Ctrl-Alt-T":function(a){var b=q(a,a.getCursor(),-1),c=q(a,b,1),d=q(a,c,1),e=q(a,d,-1);a.replaceRange(a.getRange(e,d)+a.getRange(c,e)+a.getRange(b,c),b,d)},"Ctrl-Alt-U":s(I),"Alt-Space":function(a){for(var c=a.getCursor(),d=c.ch,e=c.ch,f=a.getLine(c.line);d&&/\s/.test(f.charAt(d-1));)--d;for(;e<f.length&&/\s/.test(f.charAt(e));)++e;a.replaceRange(" ",b(c.line,d),b(c.line,e))},"Ctrl-O":s(function(a){a.replaceSelection("\n","start")}),"Ctrl-T":s(function(a){a.execCommand("transposeChars")}),"Alt-C":s(function(a){H(a,function(a){var b=a.search(/\w/);return-1==b?a:a.slice(0,b)+a.charAt(b).toUpperCase()+a.slice(b+1).toLowerCase()})}),"Alt-U":s(function(a){H(a,function(a){return a.toUpperCase()})}),"Alt-L":s(function(a){H(a,function(a){return a.toLowerCase()})}),"Alt-;":"toggleComment","Ctrl-/":s("undo"),"Shift-Ctrl--":s("undo"),"Ctrl-Z":s("undo"),"Cmd-Z":s("undo"),"Shift-Alt-,":"goDocStart","Shift-Alt-.":"goDocEnd","Ctrl-S":"findNext","Ctrl-R":"findPrev","Ctrl-G":J,"Shift-Alt-5":"replace","Alt-/":"autocomplete","Ctrl-J":"newlineAndIndent",Enter:!1,Tab:"indentAuto","Alt-G G":function(a){var b=r(a,!0);return null!=b&&b>0?a.setCursor(b-1):void G(a,"Goto line",function(b){var c;b&&!isNaN(c=Number(b))&&c==(0|c)&&c>0&&a.setCursor(c-1)})},"Ctrl-X Tab":function(a){a.indentSelection(r(a,!0)||a.getOption("indentUnit"))},"Ctrl-X Ctrl-X":function(a){a.setSelection(a.getCursor("head"),a.getCursor("anchor"))},"Ctrl-X Ctrl-S":"save","Ctrl-X Ctrl-W":"save","Ctrl-X S":"saveAll","Ctrl-X F":"open","Ctrl-X U":s("undo"),"Ctrl-X K":"close","Ctrl-X Delete":function(a){j(a,a.getCursor(),p(a,a.getCursor(),1),!0)},"Ctrl-X H":"selectAll","Ctrl-Q Tab":s("insertTab"),"Ctrl-U":C}),L={"Ctrl-G":A},N=0;10>N;++N)M(String(N));M("-")}),function(a){"object"==typeof exports&&"object"==typeof module?a(require("../lib/codemirror"),require("../addon/search/searchcursor"),require("../addon/edit/matchbrackets")):"function"==typeof define&&define.amd?define(["../lib/codemirror","../addon/search/searchcursor","../addon/edit/matchbrackets"],a):a(CodeMirror)}(function(a){"use strict";function g(b,c,e){if(0>e&&0==c.ch)return b.clipPos(d(c.line-1));var f=b.getLine(c.line);if(e>0&&c.ch>=f.length)return b.clipPos(d(c.line+1,0));for(var h,g="start",i=c.ch,j=0>e?0:f.length,k=0;i!=j;i+=e,k++){var l=f.charAt(0>e?i-1:i),m="_"!=l&&a.isWordChar(l)?"w":"o";if("w"==m&&l.toUpperCase()==l&&(m="W"),"start"==g)"o"!=m&&(g="in",h=m);else if("in"==g&&h!=m){if("w"==h&&"W"==m&&0>e&&i--,"W"==h&&"w"==m&&e>0){h="w";continue}break}}return d(c.line,i)}function h(a,b){a.extendSelectionsBy(function(c){return a.display.shift||a.doc.extend||c.empty()?g(a.doc,c.head,b):0>b?c.from():c.to()})}function j(b,c){return b.isReadOnly()?a.Pass:(b.operation(function(){for(var a=b.listSelections().length,e=[],f=-1,g=0;a>g;g++){var h=b.listSelections()[g].head;if(!(h.line<=f)){var i=d(h.line+(c?0:1),0);b.replaceRange("\n",i,null,"+insertLine"),b.indentLine(i.line,null,!0),e.push({head:i,anchor:i}),f=h.line+1}}b.setSelections(e)}),void b.execCommand("indentAuto"))}function k(b,c){for(var e=c.ch,f=e,g=b.getLine(c.line);e&&a.isWordChar(g.charAt(e-1));)--e;for(;f<g.length&&a.isWordChar(g.charAt(f));)++f;return{from:d(c.line,e),to:d(c.line,f),word:g.slice(e,f)}}function m(a){var b=a.getCursor(),c=a.scanForBracket(b,-1);if(c)for(;;){var e=a.scanForBracket(b,1);if(!e)return;if(e.ch==l.charAt(l.indexOf(c.ch)+1))return a.setSelection(d(c.pos.line,c.pos.ch+1),e.pos,!1),!0;b=d(e.pos.line,e.pos.ch+1)}}function o(b,c){if(b.isReadOnly())return a.Pass;for(var g,e=b.listSelections(),f=[],h=0;h<e.length;h++){var i=e[h];if(!i.empty()){for(var j=i.from().line,k=i.to().line;h<e.length-1&&e[h+1].from().line==k;)k=i[++h].to().line;f.push(j,k)}}f.length?g=!0:f.push(b.firstLine(),b.lastLine()),b.operation(function(){for(var a=[],e=0;e<f.length;e+=2){var h=f[e],i=f[e+1],j=d(h,0),k=d(i),l=b.getRange(j,k,!1);c?l.sort():l.sort(function(a,b){var c=a.toUpperCase(),d=b.toUpperCase();return c!=d&&(a=c,b=d),b>a?-1:a==b?0:1}),b.replaceRange(l,j,k),g&&a.push({anchor:j,head:k})}g&&b.setSelections(a,0)})}function q(b,c){b.operation(function(){for(var d=b.listSelections(),e=[],f=[],g=0;g<d.length;g++){var h=d[g];h.empty()?(e.push(g),f.push("")):f.push(c(b.getRange(h.from(),h.to())))}b.replaceSelections(f,"around","case");for(var i,g=e.length-1;g>=0;g--){var h=d[e[g]];if(!(i&&a.cmpPos(h.head,i)>0)){var j=k(b,h.head);i=j.from,b.replaceRange(c(j.word),j.from,j.to)}}})}function r(b){var c=b.getCursor("from"),d=b.getCursor("to");if(0==a.cmpPos(c,d)){var e=k(b,c);if(!e.word)return;c=e.from,d=e.to}return{from:c,to:d,query:b.getRange(c,d),word:e}}function s(a,b){var c=r(a);if(c){var e=c.query,f=a.getSearchCursor(e,b?c.to:c.from);(b?f.findNext():f.findPrevious())?a.setSelection(f.from(),f.to()):(f=a.getSearchCursor(e,b?d(a.firstLine(),0):a.clipPos(d(a.lastLine()))),(b?f.findNext():f.findPrevious())?a.setSelection(f.from(),f.to()):c.word&&a.setSelection(c.from,c.to))}}var b=a.keyMap.sublime={fallthrough:"default"},c=a.commands,d=a.Pos,e=a.keyMap["default"]==a.keyMap.macDefault,f=e?"Cmd-":"Ctrl-";c[b["Alt-Left"]="goSubwordLeft"]=function(a){h(a,-1)},c[b["Alt-Right"]="goSubwordRight"]=function(a){h(a,1)},e&&(b["Cmd-Left"]="goLineStartSmart");var i=e?"Ctrl-Alt-":"Ctrl-";c[b[i+"Up"]="scrollLineUp"]=function(a){var b=a.getScrollInfo();if(!a.somethingSelected()){var c=a.lineAtHeight(b.top+b.clientHeight,"local");a.getCursor().line>=c&&a.execCommand("goLineUp")}a.scrollTo(null,b.top-a.defaultTextHeight())},c[b[i+"Down"]="scrollLineDown"]=function(a){var b=a.getScrollInfo();if(!a.somethingSelected()){var c=a.lineAtHeight(b.top,"local")+1;a.getCursor().line<=c&&a.execCommand("goLineDown")}a.scrollTo(null,b.top+a.defaultTextHeight())},c[b["Shift-"+f+"L"]="splitSelectionByLine"]=function(a){for(var b=a.listSelections(),c=[],e=0;e<b.length;e++)for(var f=b[e].from(),g=b[e].to(),h=f.line;h<=g.line;++h)g.line>f.line&&h==g.line&&0==g.ch||c.push({anchor:h==f.line?f:d(h,0),head:h==g.line?g:d(h)});a.setSelections(c,0)},b["Shift-Tab"]="indentLess",c[b.Esc="singleSelectionTop"]=function(a){var b=a.listSelections()[0];a.setSelection(b.anchor,b.head,{scroll:!1})},c[b[f+"L"]="selectLine"]=function(a){for(var b=a.listSelections(),c=[],e=0;e<b.length;e++){var f=b[e];c.push({anchor:d(f.from().line,0),head:d(f.to().line+1,0)})}a.setSelections(c)},b["Shift-Ctrl-K"]="deleteLine",c[b[f+"Enter"]="insertLineAfter"]=function(a){return j(a,!1)},c[b["Shift-"+f+"Enter"]="insertLineBefore"]=function(a){return j(a,!0)},c[b[f+"D"]="selectNextOccurrence"]=function(b){var c=b.getCursor("from"),e=b.getCursor("to"),f=b.state.sublimeFindFullWord==b.doc.sel;if(0==a.cmpPos(c,e)){var g=k(b,c);if(!g.word)return;b.setSelection(g.from,g.to),f=!0}else{var h=b.getRange(c,e),i=f?new RegExp("\\b"+h+"\\b"):h,j=b.getSearchCursor(i,e);j.findNext()?b.addSelection(j.from(),j.to()):(j=b.getSearchCursor(i,d(b.firstLine(),0)),j.findNext()&&b.addSelection(j.from(),j.to()))}f&&(b.state.sublimeFindFullWord=b.doc.sel)};var l="(){}[]";c[b["Shift-"+f+"Space"]="selectScope"]=function(a){m(a)||a.execCommand("selectAll")},c[b["Shift-"+f+"M"]="selectBetweenBrackets"]=function(b){return m(b)?void 0:a.Pass},c[b[f+"M"]="goToBracket"]=function(b){b.extendSelectionsBy(function(c){var e=b.scanForBracket(c.head,1);if(e&&0!=a.cmpPos(e.pos,c.head))return e.pos;var f=b.scanForBracket(c.head,-1);return f&&d(f.pos.line,f.pos.ch+1)||c.head})};var n=e?"Cmd-Ctrl-":"Shift-Ctrl-";c[b[n+"Up"]="swapLineUp"]=function(b){if(b.isReadOnly())return a.Pass;for(var c=b.listSelections(),e=[],f=b.firstLine()-1,g=[],h=0;h<c.length;h++){var i=c[h],j=i.from().line-1,k=i.to().line;g.push({anchor:d(i.anchor.line-1,i.anchor.ch),head:d(i.head.line-1,i.head.ch)}),0!=i.to().ch||i.empty()||--k,j>f?e.push(j,k):e.length&&(e[e.length-1]=k),f=k}b.operation(function(){for(var a=0;a<e.length;a+=2){var c=e[a],f=e[a+1],h=b.getLine(c);b.replaceRange("",d(c,0),d(c+1,0),"+swapLine"),f>b.lastLine()?b.replaceRange("\n"+h,d(b.lastLine()),null,"+swapLine"):b.replaceRange(h+"\n",d(f,0),null,"+swapLine")}b.setSelections(g),b.scrollIntoView()})},c[b[n+"Down"]="swapLineDown"]=function(b){if(b.isReadOnly())return a.Pass;for(var c=b.listSelections(),e=[],f=b.lastLine()+1,g=c.length-1;g>=0;g--){var h=c[g],i=h.to().line+1,j=h.from().line;0!=h.to().ch||h.empty()||i--,f>i?e.push(i,j):e.length&&(e[e.length-1]=j),f=j}b.operation(function(){for(var a=e.length-2;a>=0;a-=2){var c=e[a],f=e[a+1],g=b.getLine(c);c==b.lastLine()?b.replaceRange("",d(c-1),d(c),"+swapLine"):b.replaceRange("",d(c,0),d(c+1,0),"+swapLine"),b.replaceRange(g+"\n",d(f,0),null,"+swapLine")}b.scrollIntoView()})},c[b[f+"/"]="toggleCommentIndented"]=function(a){a.toggleComment({indent:!0})},c[b[f+"J"]="joinLines"]=function(a){for(var b=a.listSelections(),c=[],e=0;e<b.length;e++){for(var f=b[e],g=f.from(),h=g.line,i=f.to().line;e<b.length-1&&b[e+1].from().line==i;)i=b[++e].to().line;c.push({start:h,end:i,anchor:!f.empty()&&g})}a.operation(function(){for(var b=0,e=[],f=0;f<c.length;f++){for(var i,g=c[f],h=g.anchor&&d(g.anchor.line-b,g.anchor.ch),j=g.start;j<=g.end;j++){var k=j-b;j==g.end&&(i=d(k,a.getLine(k).length+1)),k<a.lastLine()&&(a.replaceRange(" ",d(k),d(k+1,/^\s*/.exec(a.getLine(k+1))[0].length)),++b)}e.push({anchor:h||i,head:i})}a.setSelections(e,0)})},c[b["Shift-"+f+"D"]="duplicateLine"]=function(a){a.operation(function(){for(var b=a.listSelections().length,c=0;b>c;c++){var e=a.listSelections()[c];e.empty()?a.replaceRange(a.getLine(e.head.line)+"\n",d(e.head.line,0)):a.replaceRange(a.getRange(e.from(),e.to()),e.from())}a.scrollIntoView()})},b[f+"T"]="transposeChars",c[b.F9="sortLines"]=function(a){o(a,!0)},c[b[f+"F9"]="sortLinesInsensitive"]=function(a){o(a,!1)},c[b.F2="nextBookmark"]=function(a){var b=a.state.sublimeBookmarks;if(b)for(;b.length;){var c=b.shift(),d=c.find();if(d)return b.push(c),a.setSelection(d.from,d.to)}},c[b["Shift-F2"]="prevBookmark"]=function(a){var b=a.state.sublimeBookmarks;if(b)for(;b.length;){b.unshift(b.pop());var c=b[b.length-1].find();if(c)return a.setSelection(c.from,c.to);b.pop()}},c[b[f+"F2"]="toggleBookmark"]=function(a){for(var b=a.listSelections(),c=a.state.sublimeBookmarks||(a.state.sublimeBookmarks=[]),d=0;d<b.length;d++){for(var e=b[d].from(),f=b[d].to(),g=a.findMarks(e,f),h=0;h<g.length;h++)if(g[h].sublimeBookmark){g[h].clear();for(var i=0;i<c.length;i++)c[i]==g[h]&&c.splice(i--,1);break}h==g.length&&c.push(a.markText(e,f,{sublimeBookmark:!0,clearWhenEmpty:!1}))}},c[b["Shift-"+f+"F2"]="clearBookmarks"]=function(a){var b=a.state.sublimeBookmarks;if(b)for(var c=0;c<b.length;c++)b[c].clear();b.length=0},c[b["Alt-F2"]="selectBookmarks"]=function(a){var b=a.state.sublimeBookmarks,c=[];if(b)for(var d=0;d<b.length;d++){var e=b[d].find();e?c.push({anchor:e.from,head:e.to}):b.splice(d--,0)}c.length&&a.setSelections(c,0)},b["Alt-Q"]="wrapLines";var p=f+"K ";b[p+f+"Backspace"]="delLineLeft",c[b[p+f+"K"]="delLineRight"]=function(a){a.operation(function(){for(var b=a.listSelections(),c=b.length-1;c>=0;c--)a.replaceRange("",b[c].anchor,d(b[c].to().line),"+delete");a.scrollIntoView()})},c[b[p+f+"U"]="upcaseAtCursor"]=function(a){q(a,function(a){return a.toUpperCase()})},c[b[p+f+"L"]="downcaseAtCursor"]=function(a){q(a,function(a){return a.toLowerCase()})},c[b[p+f+"Space"]="setSublimeMark"]=function(a){a.state.sublimeMark&&a.state.sublimeMark.clear(),a.state.sublimeMark=a.setBookmark(a.getCursor())},c[b[p+f+"A"]="selectToSublimeMark"]=function(a){var b=a.state.sublimeMark&&a.state.sublimeMark.find();b&&a.setSelection(a.getCursor(),b)},c[b[p+f+"W"]="deleteToSublimeMark"]=function(b){var c=b.state.sublimeMark&&b.state.sublimeMark.find();if(c){var d=b.getCursor(),e=c;if(a.cmpPos(d,e)>0){var f=e;e=d,d=f}b.state.sublimeKilled=b.getRange(d,e),b.replaceRange("",d,e)}},c[b[p+f+"X"]="swapWithSublimeMark"]=function(a){var b=a.state.sublimeMark&&a.state.sublimeMark.find();b&&(a.state.sublimeMark.clear(),a.state.sublimeMark=a.setBookmark(a.getCursor()),a.setCursor(b))},c[b[p+f+"Y"]="sublimeYank"]=function(a){null!=a.state.sublimeKilled&&a.replaceSelection(a.state.sublimeKilled,null,"paste")},b[p+f+"G"]="clearBookmarks",c[b[p+f+"C"]="showInCenter"]=function(a){var b=a.cursorCoords(null,"local");a.scrollTo(null,(b.top+b.bottom)/2-a.getScrollInfo().clientHeight/2)},c[b["Shift-Alt-Up"]="selectLinesUpward"]=function(a){a.operation(function(){for(var b=a.listSelections(),c=0;c<b.length;c++){var e=b[c];e.head.line>a.firstLine()&&a.addSelection(d(e.head.line-1,e.head.ch))}})},c[b["Shift-Alt-Down"]="selectLinesDownward"]=function(a){a.operation(function(){for(var b=a.listSelections(),c=0;c<b.length;c++){var e=b[c];e.head.line<a.lastLine()&&a.addSelection(d(e.head.line+1,e.head.ch))}})},c[b[f+"F3"]="findUnder"]=function(a){s(a,!0)},c[b["Shift-"+f+"F3"]="findUnderPrevious"]=function(a){s(a,!1)},c[b["Alt-F3"]="findAllUnder"]=function(a){var b=r(a);if(b){for(var c=a.getSearchCursor(b.query),d=[],e=-1;c.findNext();)d.push({anchor:c.from(),head:c.to()}),c.from().line<=b.from.line&&c.from().ch<=b.from.ch&&e++;a.setSelections(d,e)}},b["Shift-"+f+"["]="fold",b["Shift-"+f+"]"]="unfold",b[p+f+"0"]=b[p+f+"j"]="unfoldAll",b[f+"I"]="findIncremental",b["Shift-"+f+"I"]="findIncrementalReverse",b[f+"H"]="replace",b.F3="findNext",b["Shift-F3"]="findPrev",a.normalizeKeyMap(b)}),function(a){"object"==typeof exports&&"object"==typeof module?a(require("../lib/codemirror"),require("../addon/search/searchcursor"),require("../addon/dialog/dialog"),require("../addon/edit/matchbrackets.js")):"function"==typeof define&&define.amd?define(["../lib/codemirror","../addon/search/searchcursor","../addon/dialog/dialog","../addon/edit/matchbrackets"],a):a(CodeMirror)}(function(a){"use strict";var b=[{keys:"<Left>",type:"keyToKey",toKeys:"h"},{keys:"<Right>",type:"keyToKey",toKeys:"l"},{keys:"<Up>",type:"keyToKey",toKeys:"k"},{keys:"<Down>",type:"keyToKey",toKeys:"j"},{keys:"<Space>",type:"keyToKey",toKeys:"l"},{keys:"<BS>",type:"keyToKey",toKeys:"h",context:"normal"},{keys:"<C-Space>",type:"keyToKey",toKeys:"W"},{keys:"<C-BS>",type:"keyToKey",toKeys:"B",context:"normal"},{keys:"<S-Space>",type:"keyToKey",toKeys:"w"},{keys:"<S-BS>",type:"keyToKey",toKeys:"b",context:"normal"},{keys:"<C-n>",type:"keyToKey",toKeys:"j"},{keys:"<C-p>",type:"keyToKey",toKeys:"k"},{keys:"<C-[>",type:"keyToKey",toKeys:"<Esc>"},{keys:"<C-c>",type:"keyToKey",toKeys:"<Esc>"},{keys:"<C-[>",type:"keyToKey",toKeys:"<Esc>",context:"insert"},{keys:"<C-c>",type:"keyToKey",toKeys:"<Esc>",context:"insert"},{keys:"s",type:"keyToKey",toKeys:"cl",context:"normal"},{keys:"s",type:"keyToKey",toKeys:"c",context:"visual"},{keys:"S",type:"keyToKey",toKeys:"cc",context:"normal"},{keys:"S",type:"keyToKey",toKeys:"VdO",context:"visual"},{keys:"<Home>",type:"keyToKey",toKeys:"0"},{keys:"<End>",type:"keyToKey",toKeys:"$"},{keys:"<PageUp>",type:"keyToKey",toKeys:"<C-b>"},{keys:"<PageDown>",type:"keyToKey",toKeys:"<C-f>"},{keys:"<CR>",type:"keyToKey",toKeys:"j^",context:"normal"},{keys:"H",type:"motion",motion:"moveToTopLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:"M",type:"motion",motion:"moveToMiddleLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:"L",type:"motion",motion:"moveToBottomLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:"h",type:"motion",motion:"moveByCharacters",motionArgs:{forward:!1}},{keys:"l",type:"motion",motion:"moveByCharacters",motionArgs:{forward:!0}},{keys:"j",type:"motion",motion:"moveByLines",motionArgs:{forward:!0,linewise:!0}},{keys:"k",type:"motion",motion:"moveByLines",motionArgs:{forward:!1,linewise:!0}},{keys:"gj",type:"motion",motion:"moveByDisplayLines",motionArgs:{forward:!0}},{keys:"gk",type:"motion",motion:"moveByDisplayLines",motionArgs:{forward:!1}},{keys:"w",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!1}},{keys:"W",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!1,bigWord:!0}},{keys:"e",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!0,inclusive:!0}},{keys:"E",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!0,bigWord:!0,inclusive:!0}},{keys:"b",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1}},{keys:"B",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1,bigWord:!0}},{keys:"ge",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!0,inclusive:!0}},{keys:"gE",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!0,bigWord:!0,inclusive:!0}},{keys:"{",type:"motion",motion:"moveByParagraph",motionArgs:{forward:!1,toJumplist:!0}},{keys:"}",type:"motion",motion:"moveByParagraph",motionArgs:{forward:!0,toJumplist:!0}},{keys:"<C-f>",type:"motion",motion:"moveByPage",motionArgs:{forward:!0}},{keys:"<C-b>",type:"motion",motion:"moveByPage",motionArgs:{forward:!1}},{keys:"<C-d>",type:"motion",motion:"moveByScroll",motionArgs:{forward:!0,explicitRepeat:!0}},{keys:"<C-u>",type:"motion",motion:"moveByScroll",motionArgs:{forward:!1,explicitRepeat:!0}},{keys:"gg",type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!1,explicitRepeat:!0,linewise:!0,toJumplist:!0}},{keys:"G",type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!0,explicitRepeat:!0,linewise:!0,toJumplist:!0}},{keys:"0",type:"motion",motion:"moveToStartOfLine"},{keys:"^",type:"motion",motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:"+",type:"motion",motion:"moveByLines",motionArgs:{forward:!0,toFirstChar:!0}},{keys:"-",type:"motion",motion:"moveByLines",motionArgs:{forward:!1,toFirstChar:!0}},{keys:"_",type:"motion",motion:"moveByLines",motionArgs:{forward:!0,toFirstChar:!0,repeatOffset:-1}},{keys:"$",type:"motion",motion:"moveToEol",motionArgs:{inclusive:!0}},{keys:"%",type:"motion",motion:"moveToMatchedSymbol",motionArgs:{inclusive:!0,toJumplist:!0}},{keys:"f<character>",type:"motion",motion:"moveToCharacter",motionArgs:{forward:!0,inclusive:!0}},{keys:"F<character>",type:"motion",motion:"moveToCharacter",motionArgs:{forward:!1}},{keys:"t<character>",type:"motion",motion:"moveTillCharacter",motionArgs:{forward:!0,inclusive:!0}},{keys:"T<character>",type:"motion",motion:"moveTillCharacter",motionArgs:{forward:!1}},{keys:";",type:"motion",motion:"repeatLastCharacterSearch",motionArgs:{forward:!0}},{keys:",",type:"motion",motion:"repeatLastCharacterSearch",motionArgs:{forward:!1}},{keys:"'<character>",type:"motion",motion:"goToMark",motionArgs:{toJumplist:!0,linewise:!0}},{keys:"`<character>",type:"motion",motion:"goToMark",motionArgs:{toJumplist:!0}},{keys:"]`",type:"motion",motion:"jumpToMark",motionArgs:{forward:!0}},{keys:"[`",type:"motion",motion:"jumpToMark",motionArgs:{forward:!1}},{keys:"]'",type:"motion",motion:"jumpToMark",motionArgs:{forward:!0,linewise:!0}},{keys:"['",type:"motion",motion:"jumpToMark",motionArgs:{forward:!1,linewise:!0}},{keys:"]p",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!0,isEdit:!0,matchIndent:!0}},{keys:"[p",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!1,isEdit:!0,matchIndent:!0}},{keys:"]<character>",type:"motion",motion:"moveToSymbol",motionArgs:{forward:!0,toJumplist:!0}},{keys:"[<character>",type:"motion",motion:"moveToSymbol",motionArgs:{forward:!1,toJumplist:!0}},{keys:"|",type:"motion",motion:"moveToColumn"},{keys:"o",type:"motion",motion:"moveToOtherHighlightedEnd",context:"visual"},{keys:"O",type:"motion",motion:"moveToOtherHighlightedEnd",motionArgs:{sameLine:!0},context:"visual"},{keys:"d",type:"operator",operator:"delete"},{keys:"y",type:"operator",operator:"yank"},{keys:"c",type:"operator",operator:"change"},{keys:">",type:"operator",operator:"indent",operatorArgs:{indentRight:!0}},{keys:"<",type:"operator",operator:"indent",operatorArgs:{indentRight:!1}},{keys:"g~",type:"operator",operator:"changeCase"},{keys:"gu",type:"operator",operator:"changeCase",operatorArgs:{toLower:!0},isEdit:!0},{keys:"gU",type:"operator",operator:"changeCase",operatorArgs:{toLower:!1},isEdit:!0},{keys:"n",type:"motion",motion:"findNext",motionArgs:{forward:!0,toJumplist:!0}},{keys:"N",type:"motion",motion:"findNext",motionArgs:{forward:!1,toJumplist:!0}},{keys:"x",type:"operatorMotion",operator:"delete",motion:"moveByCharacters",motionArgs:{forward:!0},operatorMotionArgs:{visualLine:!1}},{keys:"X",type:"operatorMotion",operator:"delete",motion:"moveByCharacters",motionArgs:{forward:!1},operatorMotionArgs:{visualLine:!0}},{keys:"D",type:"operatorMotion",operator:"delete",motion:"moveToEol",motionArgs:{inclusive:!0},context:"normal"},{keys:"D",type:"operator",operator:"delete",operatorArgs:{linewise:!0},context:"visual"},{keys:"Y",type:"operatorMotion",operator:"yank",motion:"moveToEol",motionArgs:{inclusive:!0},context:"normal"},{keys:"Y",type:"operator",operator:"yank",operatorArgs:{linewise:!0},context:"visual"},{keys:"C",type:"operatorMotion",operator:"change",motion:"moveToEol",motionArgs:{inclusive:!0},context:"normal"},{keys:"C",type:"operator",operator:"change",operatorArgs:{linewise:!0},context:"visual"},{keys:"~",type:"operatorMotion",operator:"changeCase",motion:"moveByCharacters",motionArgs:{forward:!0},operatorArgs:{shouldMoveCursor:!0},context:"normal"},{keys:"~",type:"operator",operator:"changeCase",context:"visual"},{keys:"<C-w>",type:"operatorMotion",operator:"delete",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1},context:"insert"},{keys:"<C-i>",type:"action",action:"jumpListWalk",actionArgs:{forward:!0}},{keys:"<C-o>",type:"action",action:"jumpListWalk",actionArgs:{forward:!1}},{keys:"<C-e>",type:"action",action:"scroll",actionArgs:{forward:!0,linewise:!0}},{keys:"<C-y>",type:"action",action:"scroll",actionArgs:{forward:!1,linewise:!0}},{keys:"a",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"charAfter"},context:"normal"},{keys:"A",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"eol"},context:"normal"},{keys:"A",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"endOfSelectedArea"},context:"visual"},{keys:"i",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"inplace"},context:"normal"},{keys:"I",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"firstNonBlank"},context:"normal"},{keys:"I",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"startOfSelectedArea"},context:"visual"},{keys:"o",type:"action",action:"newLineAndEnterInsertMode",isEdit:!0,interlaceInsertRepeat:!0,actionArgs:{after:!0},context:"normal"},{keys:"O",type:"action",action:"newLineAndEnterInsertMode",isEdit:!0,interlaceInsertRepeat:!0,actionArgs:{after:!1},context:"normal"},{keys:"v",type:"action",action:"toggleVisualMode"},{keys:"V",type:"action",action:"toggleVisualMode",actionArgs:{linewise:!0}},{keys:"<C-v>",type:"action",action:"toggleVisualMode",actionArgs:{blockwise:!0}},{keys:"<C-q>",type:"action",action:"toggleVisualMode",actionArgs:{blockwise:!0}},{keys:"gv",type:"action",action:"reselectLastSelection"},{keys:"J",type:"action",action:"joinLines",isEdit:!0},{keys:"p",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!0,isEdit:!0}},{keys:"P",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!1,isEdit:!0}},{keys:"r<character>",type:"action",action:"replace",isEdit:!0},{keys:"@<character>",type:"action",action:"replayMacro"},{keys:"q<character>",type:"action",action:"enterMacroRecordMode"},{keys:"R",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{replace:!0}},{keys:"u",type:"action",action:"undo",context:"normal"},{keys:"u",type:"operator",operator:"changeCase",operatorArgs:{toLower:!0},context:"visual",isEdit:!0},{keys:"U",type:"operator",operator:"changeCase",operatorArgs:{toLower:!1},context:"visual",isEdit:!0},{keys:"<C-r>",type:"action",action:"redo"},{keys:"m<character>",type:"action",action:"setMark"},{keys:'"<character>',type:"action",action:"setRegister"},{keys:"zz",type:"action",action:"scrollToCursor",actionArgs:{position:"center"}},{keys:"z.",type:"action",action:"scrollToCursor",actionArgs:{position:"center"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:"zt",type:"action",action:"scrollToCursor",actionArgs:{position:"top"}},{keys:"z<CR>",type:"action",action:"scrollToCursor",actionArgs:{position:"top"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:"z-",type:"action",action:"scrollToCursor",actionArgs:{position:"bottom"}},{keys:"zb",type:"action",action:"scrollToCursor",actionArgs:{position:"bottom"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:".",type:"action",action:"repeatLastEdit"},{keys:"<C-a>",type:"action",action:"incrementNumberToken",isEdit:!0,actionArgs:{increase:!0,backtrack:!1}},{keys:"<C-x>",type:"action",action:"incrementNumberToken",isEdit:!0,actionArgs:{increase:!1,backtrack:!1}},{keys:"a<character>",type:"motion",motion:"textObjectManipulation"},{keys:"i<character>",type:"motion",motion:"textObjectManipulation",motionArgs:{textObjectInner:!0}},{keys:"/",type:"search",searchArgs:{forward:!0,querySrc:"prompt",toJumplist:!0}},{keys:"?",type:"search",searchArgs:{forward:!1,querySrc:"prompt",toJumplist:!0}},{keys:"*",type:"search",searchArgs:{forward:!0,querySrc:"wordUnderCursor",wholeWordOnly:!0,toJumplist:!0}},{keys:"#",type:"search",searchArgs:{forward:!1,querySrc:"wordUnderCursor",wholeWordOnly:!0,toJumplist:!0}},{keys:"g*",type:"search",searchArgs:{forward:!0,querySrc:"wordUnderCursor",toJumplist:!0}},{keys:"g#",type:"search",searchArgs:{forward:!1,querySrc:"wordUnderCursor",toJumplist:!0}},{keys:":",type:"ex"}],c=[{name:"colorscheme",shortName:"colo"},{name:"map"},{name:"imap",shortName:"im"},{name:"nmap",shortName:"nm"},{name:"vmap",shortName:"vm"},{name:"unmap"},{name:"write",shortName:"w"},{name:"undo",shortName:"u"},{name:"redo",shortName:"red"},{name:"set",shortName:"se"},{name:"set",shortName:"se"},{name:"setlocal",shortName:"setl"},{name:"setglobal",shortName:"setg"},{name:"sort",shortName:"sor"},{name:"substitute",shortName:"s",possiblyAsync:!0},{name:"nohlsearch",shortName:"noh"},{name:"yank",shortName:"y"},{name:"delmarks",shortName:"delm"},{name:"registers",shortName:"reg",excludeFromCommandHistory:!0},{name:"global",shortName:"g"}],d=a.Pos,e=function(){function e(b){b.setOption("disableInput",!0),b.setOption("showCursorWhenSelecting",!1),a.signal(b,"vim-mode-change",{mode:"normal"}),b.on("cursorActivity",Cb),K(b),a.on(b.getInputField(),"paste",m(b))}function f(b){b.setOption("disableInput",!1),b.off("cursorActivity",Cb),a.off(b.getInputField(),"paste",m(b)),b.state.vim=null}function g(b,c){this==a.keyMap.vim&&a.rmClass(b.getWrapperElement(),"cm-fat-cursor"),c&&c.attach==h||f(b,!1)}function h(b,c){this==a.keyMap.vim&&a.addClass(b.getWrapperElement(),"cm-fat-cursor"),c&&c.attach==h||e(b)}function i(b,c){if(!c)return void 0;var d=l(b);if(!d)return!1;var e=a.Vim.findKey(c,d);return"function"==typeof e&&a.signal(c,"vim-keypress",d),
e}function l(a){if("'"==a.charAt(0))return a.charAt(1);var b=a.split(/-(?!$)/),c=b[b.length-1];if(1==b.length&&1==b[0].length)return!1;if(2==b.length&&"Shift"==b[0]&&1==c.length)return!1;for(var d=!1,e=0;e<b.length;e++){var f=b[e];f in j?b[e]=j[f]:d=!0,f in k&&(b[e]=k[f])}return d?(A(c)&&(b[b.length-1]=c.toLowerCase()),"<"+b.join("-")+">"):!1}function m(a){var b=a.state.vim;return b.onPasteFn||(b.onPasteFn=function(){b.insertMode||(a.setCursor(da(a.getCursor(),0,1)),_.enterInsertMode(a,{},b))}),b.onPasteFn}function q(a,b){for(var c=[],d=a;a+b>d;d++)c.push(String.fromCharCode(d));return c}function w(a,b){return b>=a.firstLine()&&b<=a.lastLine()}function x(a){return/^[a-z]$/.test(a)}function y(a){return-1!="()[]{}".indexOf(a)}function z(a){return n.test(a)}function A(a){return/^[A-Z]$/.test(a)}function B(a){return/^\s*$/.test(a)}function C(a,b){for(var c=0;c<b.length;c++)if(b[c]==a)return!0;return!1}function E(a,b,c,d,e){if(void 0===b&&!e)throw Error("defaultValue is required unless callback is provided");if(c||(c="string"),D[a]={type:c,defaultValue:b,callback:e},d)for(var f=0;f<d.length;f++)D[d[f]]=D[a];b&&F(a,b)}function F(a,b,c,d){var e=D[a];d=d||{};var f=d.scope;if(!e)throw Error("Unknown option: "+a);if("boolean"==e.type){if(b&&b!==!0)throw Error("Invalid argument: "+a+"="+b);b!==!1&&(b=!0)}e.callback?("local"!==f&&e.callback(b,void 0),"global"!==f&&c&&e.callback(b,c)):("local"!==f&&(e.value="boolean"==e.type?!!b:b),"global"!==f&&c&&(c.state.vim.options[a]={value:b}))}function G(a,b,c){var d=D[a];c=c||{};var e=c.scope;if(!d)throw Error("Unknown option: "+a);{if(!d.callback){var f="global"!==e&&b&&b.state.vim.options[a];return(f||"local"!==e&&d||{}).value}var f=b&&d.callback(void 0,b);if("global"!==e&&void 0!==f)return f;if("local"!==e)return d.callback()}}function J(){this.latestRegister=void 0,this.isPlaying=!1,this.isRecording=!1,this.replaySearchQueries=[],this.onRecordingDone=void 0,this.lastInsertModeChanges=I()}function K(a){return a.state.vim||(a.state.vim={inputState:new P,lastEditInputState:void 0,lastEditActionCommand:void 0,lastHPos:-1,lastHSPos:-1,lastMotion:null,marks:{},fakeCursor:null,insertMode:!1,insertModeRepeat:void 0,visualMode:!1,visualLine:!1,visualBlock:!1,lastSelection:null,lastPastedText:null,sel:{},options:{}}),a.state.vim}function M(){L={searchQuery:null,searchIsReversed:!1,lastSubstituteReplacePart:void 0,jumpList:H(),macroModeState:new J,lastCharacterSearch:{increment:0,forward:!0,selectedCharacter:""},registerController:new T({}),searchHistoryController:new U({}),exCommandHistoryController:new U({})};for(var a in D){var b=D[a];b.value=b.defaultValue}}function P(){this.prefixRepeat=[],this.motionRepeat=[],this.operator=null,this.operatorArgs=null,this.motion=null,this.motionArgs=null,this.keyBuffer=[],this.registerName=null}function Q(b,c){b.state.vim.inputState=new P,a.signal(b,"vim-command-done",c)}function R(a,b,c){this.clear(),this.keyBuffer=[a||""],this.insertModeChanges=[],this.searchQueries=[],this.linewise=!!b,this.blockwise=!!c}function S(a,b){var c=L.registerController.registers[a];if(!a||1!=a.length)throw Error("Register name must be 1 character");if(c[a])throw Error("Register already defined "+a);c[a]=b,v.push(a)}function T(a){this.registers=a,this.unnamedRegister=a['"']=new R,a["."]=new R,a[":"]=new R,a["/"]=new R}function U(){this.historyBuffer=[],this.iterator=0,this.initialPrefix=null}function X(a,b){W[a]=b}function Y(a,b){for(var c=[],d=0;b>d;d++)c.push(a);return c}function $(a,b){Z[a]=b}function aa(a,b){_[a]=b}function ba(a,b,c){var e=Math.min(Math.max(a.firstLine(),b.line),a.lastLine()),f=pa(a,e)-1;f=c?f+1:f;var g=Math.min(Math.max(0,b.ch),f);return d(e,g)}function ca(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}function da(a,b,c){return"object"==typeof b&&(c=b.ch,b=b.line),d(a.line+b,a.ch+c)}function ea(a,b){return{line:b.line-a.line,ch:b.line-a.line}}function fa(a,b,c,d){for(var e,f=[],g=[],h=0;h<b.length;h++){var i=b[h];"insert"==c&&"insert"!=i.context||i.context&&i.context!=c||d.operator&&"action"==i.type||!(e=ga(a,i.keys))||("partial"==e&&f.push(i),"full"==e&&g.push(i))}return{partial:f.length&&f,full:g.length&&g}}function ga(a,b){if("<character>"==b.slice(-11)){var c=b.length-11,d=a.slice(0,c),e=b.slice(0,c);return d==e&&a.length>c?"full":0==e.indexOf(d)?"partial":!1}return a==b?"full":0==b.indexOf(a)?"partial":!1}function ha(a){var b=/^.*(<[\w\-]+>)$/.exec(a),c=b?b[1]:a.slice(-1);if(c.length>1)switch(c){case"<CR>":c="\n";break;case"<Space>":c=" "}return c}function ia(a,b,c){return function(){for(var d=0;c>d;d++)b(a)}}function ja(a){return d(a.line,a.ch)}function ka(a,b){return a.ch==b.ch&&a.line==b.line}function la(a,b){return a.line<b.line?!0:a.line==b.line&&a.ch<b.ch?!0:!1}function ma(a,b){return arguments.length>2&&(b=ma.apply(void 0,Array.prototype.slice.call(arguments,1))),la(a,b)?a:b}function na(a,b){return arguments.length>2&&(b=na.apply(void 0,Array.prototype.slice.call(arguments,1))),la(a,b)?b:a}function oa(a,b,c){var d=la(a,b),e=la(b,c);return d&&e}function pa(a,b){return a.getLine(b).length}function qa(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}function ra(a){return a.replace(/([.?*+$\[\]\/\\(){}|\-])/g,"\\$1")}function sa(a,b,c){var e=pa(a,b),f=new Array(c-e+1).join(" ");a.setCursor(d(b,e)),a.replaceRange(f,a.getCursor())}function ta(a,b){var c=[],e=a.listSelections(),f=ja(a.clipPos(b)),g=!ka(b,f),h=a.getCursor("head"),i=va(e,h),j=ka(e[i].head,e[i].anchor),k=e.length-1,l=k-i>i?k:0,m=e[l].anchor,n=Math.min(m.line,f.line),o=Math.max(m.line,f.line),p=m.ch,q=f.ch,r=e[l].head.ch-p,s=q-p;r>0&&0>=s?(p++,g||q--):0>r&&s>=0?(p--,j||q++):0>r&&-1==s&&(p--,q++);for(var t=n;o>=t;t++){var u={anchor:new d(t,p),head:new d(t,q)};c.push(u)}return i=f.line==o?c.length-1:0,a.setSelections(c),b.ch=q,m.ch=p,m}function ua(a,b,c){for(var d=[],e=0;c>e;e++){var f=da(b,e,0);d.push({anchor:f,head:f})}a.setSelections(d,0)}function va(a,b,c){for(var d=0;d<a.length;d++){var e="head"!=c&&ka(a[d].anchor,b),f="anchor"!=c&&ka(a[d].head,b);if(e||f)return d}return-1}function wa(a,b){var c=b.lastSelection,e=function(){var b=a.listSelections(),c=b[0],d=b[b.length-1],e=la(c.anchor,c.head)?c.anchor:c.head,f=la(d.anchor,d.head)?d.head:d.anchor;return[e,f]},f=function(){var b=a.getCursor(),e=a.getCursor(),f=c.visualBlock;if(f){var g=f.width,h=f.height;e=d(b.line+h,b.ch+g);for(var i=[],j=b.line;j<e.line;j++){var k=d(j,b.ch),l=d(j,e.ch),m={anchor:k,head:l};i.push(m)}a.setSelections(i)}else{var n=c.anchorMark.find(),o=c.headMark.find(),p=o.line-n.line,q=o.ch-n.ch;e={line:e.line+p,ch:p?e.ch:q+e.ch},c.visualLine&&(b=d(b.line,0),e=d(e.line,pa(a,e.line))),a.setSelection(b,e)}return[b,e]};return b.visualMode?e():f()}function xa(a,b){var c=b.sel.anchor,d=b.sel.head;b.lastPastedText&&(d=a.posFromIndex(a.indexFromPos(c)+b.lastPastedText.length),b.lastPastedText=null),b.lastSelection={anchorMark:a.setBookmark(c),headMark:a.setBookmark(d),anchor:ja(c),head:ja(d),visualMode:b.visualMode,visualLine:b.visualLine,visualBlock:b.visualBlock}}function ya(a,b,c){var h,e=a.state.vim.sel,f=e.head,g=e.anchor;return la(c,b)&&(h=c,c=b,b=h),la(f,g)?(f=ma(b,f),g=na(g,c)):(g=ma(b,g),f=na(f,c),f=da(f,0,-1),-1==f.ch&&f.line!=a.firstLine()&&(f=d(f.line-1,pa(a,f.line-1)))),[g,f]}function za(a,b,c){var d=a.state.vim;b=b||d.sel;var c=c||d.visualLine?"line":d.visualBlock?"block":"char",e=Aa(a,b,c);a.setSelections(e.ranges,e.primary),Db(a)}function Aa(a,b,c,e){var f=ja(b.head),g=ja(b.anchor);if("char"==c){var h=e||la(b.head,b.anchor)?0:1,i=la(b.head,b.anchor)?1:0;return f=da(b.head,0,h),g=da(b.anchor,0,i),{ranges:[{anchor:g,head:f}],primary:0}}if("line"==c){if(la(b.head,b.anchor))f.ch=0,g.ch=pa(a,g.line);else{g.ch=0;var j=a.lastLine();f.line>j&&(f.line=j),f.ch=pa(a,f.line)}return{ranges:[{anchor:g,head:f}],primary:0}}if("block"==c){for(var k=Math.min(g.line,f.line),l=Math.min(g.ch,f.ch),m=Math.max(g.line,f.line),n=Math.max(g.ch,f.ch)+1,o=m-k+1,p=f.line==k?0:o-1,q=[],r=0;o>r;r++)q.push({anchor:d(k+r,l),head:d(k+r,n)});return{ranges:q,primary:p}}}function Ba(a){var b=a.getCursor("head");return 1==a.getSelection().length&&(b=ma(b,a.getCursor("anchor"))),b}function Ca(b,c){var d=b.state.vim;c!==!1&&b.setCursor(ba(b,d.sel.head)),xa(b,d),d.visualMode=!1,d.visualLine=!1,d.visualBlock=!1,a.signal(b,"vim-mode-change",{mode:"normal"}),d.fakeCursor&&d.fakeCursor.clear()}function Da(a,b,c){var d=a.getRange(b,c);if(/\n\s*$/.test(d)){var e=d.split("\n");e.pop();for(var f,f=e.pop();e.length>0&&f&&B(f);f=e.pop())c.line--,c.ch=0;f?(c.line--,c.ch=pa(a,c.line)):c.ch=0}}function Ea(a,b,c){b.ch=0,c.ch=0,c.line++}function Fa(a){if(!a)return 0;var b=a.search(/\S/);return-1==b?a.length:b}function Ga(a,b,c,e,f){for(var g=Ba(a),h=a.getLine(g.line),i=g.ch,j=f?o[0]:p[0];!j(h.charAt(i));)if(i++,i>=h.length)return null;e?j=p[0]:(j=o[0],j(h.charAt(i))||(j=o[1]));for(var k=i,l=i;j(h.charAt(k))&&k<h.length;)k++;for(;j(h.charAt(l))&&l>=0;)l--;if(l++,b){for(var m=k;/\s/.test(h.charAt(k))&&k<h.length;)k++;if(m==k){for(var n=l;/\s/.test(h.charAt(l-1))&&l>0;)l--;l||(l=n)}}return{start:d(g.line,l),end:d(g.line,k)}}function Ha(a,b,c){ka(b,c)||L.jumpList.add(a,b,c)}function Ia(a,b){L.lastCharacterSearch.increment=a,L.lastCharacterSearch.forward=b.forward,L.lastCharacterSearch.selectedCharacter=b.selectedCharacter}function La(a,b,c,e){var f=ja(a.getCursor()),g=c?1:-1,h=c?a.lineCount():-1,i=f.ch,j=f.line,k=a.getLine(j),l={lineText:k,nextCh:k.charAt(i),lastCh:null,index:i,symb:e,reverseSymb:(c?{")":"(","}":"{"}:{"(":")","{":"}"})[e],forward:c,depth:0,curMoveThrough:!1},m=Ja[e];if(!m)return f;var n=Ka[m].init,o=Ka[m].isComplete;for(n&&n(l);j!==h&&b;){if(l.index+=g,l.nextCh=l.lineText.charAt(l.index),!l.nextCh){if(j+=g,l.lineText=a.getLine(j)||"",g>0)l.index=0;else{var p=l.lineText.length;l.index=p>0?p-1:0}l.nextCh=l.lineText.charAt(l.index)}o(l)&&(f.line=j,f.ch=l.index,b--)}return l.nextCh||l.curMoveThrough?d(j,l.index):f}function Ma(a,b,c,d,e){var f=b.line,g=b.ch,h=a.getLine(f),i=c?1:-1,j=d?p:o;if(e&&""==h){if(f+=i,h=a.getLine(f),!w(a,f))return null;g=c?0:h.length}for(;;){if(e&&""==h)return{from:0,to:0,line:f};for(var k=i>0?h.length:-1,l=k,m=k;g!=k;){for(var n=!1,q=0;q<j.length&&!n;++q)if(j[q](h.charAt(g))){for(l=g;g!=k&&j[q](h.charAt(g));)g+=i;if(m=g,n=l!=m,l==b.ch&&f==b.line&&m==l+i)continue;return{from:Math.min(l,m+1),to:Math.max(l,m),line:f}}n||(g+=i)}if(f+=i,!w(a,f))return null;h=a.getLine(f),g=i>0?0:h.length}}function Na(a,b,c,e,f,g){var h=ja(b),i=[];(e&&!f||!e&&f)&&c++;for(var j=!(e&&f),k=0;c>k;k++){var l=Ma(a,b,e,g,j);if(!l){var m=pa(a,a.lastLine());i.push(e?{line:a.lastLine(),from:m,to:m}:{line:0,from:0,to:0});break}i.push(l),b=d(l.line,e?l.to-1:l.from)}var n=i.length!=c,o=i[0],p=i.pop();return e&&!f?(n||o.from==h.ch&&o.line==h.line||(p=i.pop()),d(p.line,p.from)):e&&f?d(p.line,p.to-1):!e&&f?(n||o.to==h.ch&&o.line==h.line||(p=i.pop()),d(p.line,p.to)):d(p.line,p.from)}function Oa(a,b,c,e){for(var h,f=a.getCursor(),g=f.ch,i=0;b>i;i++){var j=a.getLine(f.line);if(h=Ra(g,j,e,c,!0),-1==h)return null;g=h}return d(a.getCursor().line,h)}function Pa(a,b){var c=a.getCursor().line;return ba(a,d(c,b-1))}function Qa(a,b,c,d){C(c,u)&&(b.marks[c]&&b.marks[c].clear(),b.marks[c]=a.setBookmark(d))}function Ra(a,b,c,d,e){var f;return d?(f=b.indexOf(c,a+1),-1==f||e||(f-=1)):(f=b.lastIndexOf(c,a-1),-1==f||e||(f+=1)),f}function Sa(a,b,c,e,f){function m(b){return!a.getLine(b)}function n(a,b,c){return c?m(a)!=m(a+b):!m(a)&&m(a+b)}var j,k,g=b.line,h=a.firstLine(),i=a.lastLine(),l=g;if(e){for(;l>=h&&i>=l&&c>0;)n(l,e)&&c--,l+=e;return new d(l,0)}var o=a.state.vim;if(o.visualLine&&n(g,1,!0)){var p=o.sel.anchor;n(p.line,-1,!0)&&(f&&p.line==g||(g+=1))}var q=m(g);for(l=g;i>=l&&c;l++)n(l,1,!0)&&(f&&m(l)==q||c--);for(k=new d(l,0),l>i&&!q?q=!0:f=!1,l=g;l>h&&(f&&m(l)!=q&&l!=g||!n(l,-1,!0));l--);return j=new d(l,0),{start:j,end:k}}function Ta(a,b,c,e){var g,h,f=b,i={"(":/[()]/,")":/[()]/,"[":/[[\]]/,"]":/[[\]]/,"{":/[{}]/,"}":/[{}]/}[c],j={"(":"(",")":"(","[":"[","]":"[","{":"{","}":"{"}[c],k=a.getLine(f.line).charAt(f.ch),l=k===j?1:0;if(g=a.scanForBracket(d(f.line,f.ch+l),-1,null,{bracketRegex:i}),h=a.scanForBracket(d(f.line,f.ch+l),1,null,{bracketRegex:i}),!g||!h)return{start:f,end:f};if(g=g.pos,h=h.pos,g.line==h.line&&g.ch>h.ch||g.line>h.line){var m=g;g=h,h=m}return e?h.ch+=1:g.ch+=1,{start:g,end:h}}function Ua(a,b,c,e){var i,j,k,l,f=ja(b),g=a.getLine(f.line),h=g.split(""),m=h.indexOf(c);if(f.ch<m?f.ch=m:m<f.ch&&h[f.ch]==c&&(j=f.ch,--f.ch),h[f.ch]!=c||j)for(k=f.ch;k>-1&&!i;k--)h[k]==c&&(i=k+1);else i=f.ch+1;if(i&&!j)for(k=i,l=h.length;l>k&&!j;k++)h[k]==c&&(j=k);return i&&j?(e&&(--i,++j),{start:d(f.line,i),end:d(f.line,j)}):{start:f,end:f}}function Va(){}function Wa(a){var b=a.state.vim;return b.searchState_||(b.searchState_=new Va)}function Xa(a,b,c,d,e){a.openDialog?a.openDialog(b,d,{bottom:!0,value:e.value,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,selectValueOnOpen:!1}):d(prompt(c,""))}function Ya(a){var b=Za(a)||[];if(!b.length)return[];var c=[];if(0===b[0]){for(var d=0;d<b.length;d++)"number"==typeof b[d]&&c.push(a.substring(b[d]+1,b[d+1]));return c}}function Za(a){for(var b=!1,c=[],d=0;d<a.length;d++){var e=a.charAt(d);b||"/"!=e||c.push(d),b=!b&&"\\"==e}return c}function $a(a){for(var b="|(){",c="}",d=!1,e=[],f=-1;f<a.length;f++){var g=a.charAt(f)||"",h=a.charAt(f+1)||"",i=h&&-1!=b.indexOf(h);d?("\\"===g&&i||e.push(g),d=!1):"\\"===g?(d=!0,h&&-1!=c.indexOf(h)&&(i=!0),i&&"\\"!==h||e.push(g)):(e.push(g),i&&"\\"!==h&&e.push("\\"))}return e.join("")}function ab(a){for(var b=!1,c=[],d=-1;d<a.length;d++){var e=a.charAt(d)||"",f=a.charAt(d+1)||"";_a[e+f]?(c.push(_a[e+f]),d++):b?(c.push(e),b=!1):"\\"===e?(b=!0,z(f)||"$"===f?c.push("$"):"/"!==f&&"\\"!==f&&c.push("\\")):("$"===e&&c.push("$"),c.push(e),"/"===f&&c.push("\\"))}return c.join("")}function cb(b){for(var c=new a.StringStream(b),d=[];!c.eol();){for(;c.peek()&&"\\"!=c.peek();)d.push(c.next());var e=!1;for(var f in bb)if(c.match(f,!0)){e=!0,d.push(bb[f]);break}e||d.push(c.next())}return d.join("")}function db(a,b,c){var d=L.registerController.getRegister("/");if(d.setText(a),a instanceof RegExp)return a;var f,g,e=Za(a);if(e.length){f=a.substring(0,e[0]);var h=a.substring(e[0]);g=-1!=h.indexOf("i")}else f=a;if(!f)return null;G("pcre")||(f=$a(f)),c&&(b=/^[^A-Z]*$/.test(f));var i=new RegExp(f,b||g?"i":void 0);return i}function eb(a,b){a.openNotification?a.openNotification('<span style="color: red">'+b+"</span>",{bottom:!0,duration:5e3}):alert(b)}function fb(a,b){var c='<span style="font-family: monospace; white-space: pre">'+(a||"")+'<input type="text"></span>';return b&&(c+=' <span style="color: #888">'+b+"</span>"),c}function hb(a,b){var c=(b.prefix||"")+" "+(b.desc||""),d=fb(b.prefix,b.desc);Xa(a,d,c,b.onClose,b)}function ib(a,b){if(a instanceof RegExp&&b instanceof RegExp){for(var c=["global","multiline","ignoreCase","source"],d=0;d<c.length;d++){var e=c[d];if(a[e]!==b[e])return!1}return!0}return!1}function jb(a,b,c,d){if(b){var e=Wa(a),f=db(b,!!c,!!d);if(f)return lb(a,f),ib(f,e.getQuery())?f:(e.setQuery(f),f)}}function kb(a){if("^"==a.source.charAt(0))var b=!0;return{token:function(c){if(b&&!c.sol())return void c.skipToEnd();var d=c.match(a,!1);if(d)return 0==d[0].length?(c.next(),"searching"):c.sol()||(c.backUp(1),a.exec(c.next()+d[0]))?(c.match(a),"searching"):(c.next(),null);for(;!c.eol()&&(c.next(),!c.match(a,!1)););},query:a}}function lb(a,b){var c=Wa(a),d=c.getOverlay();d&&b==d.query||(d&&a.removeOverlay(d),d=kb(b),a.addOverlay(d),a.showMatchesOnScrollbar&&(c.getScrollbarAnnotate()&&c.getScrollbarAnnotate().clear(),c.setScrollbarAnnotate(a.showMatchesOnScrollbar(b))),c.setOverlay(d))}function mb(a,b,c,e){return void 0===e&&(e=1),a.operation(function(){for(var f=a.getCursor(),g=a.getSearchCursor(c,f),h=0;e>h;h++){var i=g.find(b);if(0==h&&i&&ka(g.from(),f)&&(i=g.find(b)),!i&&(g=a.getSearchCursor(c,b?d(a.lastLine()):d(a.firstLine(),0)),!g.find(b)))return}return g.from()})}function nb(a){var b=Wa(a);a.removeOverlay(Wa(a).getOverlay()),b.setOverlay(null),b.getScrollbarAnnotate()&&(b.getScrollbarAnnotate().clear(),b.setScrollbarAnnotate(null))}function ob(a,b,c){return"number"!=typeof a&&(a=a.line),b instanceof Array?C(a,b):c?a>=b&&c>=a:a==b}function pb(a){var b=a.getScrollInfo(),c=6,d=10,e=a.coordsChar({left:0,top:c+b.top},"local"),f=b.clientHeight-d+b.top,g=a.coordsChar({left:0,top:f},"local");return{top:e.line,bottom:g.line}}function tb(b,c,d,e,f,g,h,i,j){function m(){b.operation(function(){for(;!k;)n(),o();p()})}function n(){var a=b.getRange(g.from(),g.to()),c=a.replace(h,i);g.replace(c)}function o(){for(;g.findNext()&&ob(g.from(),e,f);)if(d||!l||g.from().line!=l.line)return b.scrollIntoView(g.from(),30),b.setSelection(g.from(),g.to()),l=g.from(),void(k=!1);k=!0}function p(a){if(a&&a(),b.focus(),l){b.setCursor(l);var c=b.state.vim;c.exMode=!1,c.lastHPos=c.lastHSPos=l.ch}j&&j()}function q(c,d,e){a.e_stop(c);var f=a.keyName(c);switch(f){case"Y":n(),o();break;case"N":o();break;case"A":var g=j;j=void 0,b.operation(m),j=g;break;case"L":n();case"Q":case"Esc":case"Ctrl-C":case"Ctrl-[":p(e)}return k&&p(e),!0}b.state.vim.exMode=!0;var k=!1,l=g.from();return o(),k?void eb(b,"No matches for "+h.source):c?void hb(b,{prefix:"replace with <strong>"+i+"</strong> (y/n/a/q/l)",onKeyDown:q}):(m(),void(j&&j()))}function ub(b){var c=b.state.vim,d=L.macroModeState,e=L.registerController.getRegister("."),f=d.isPlaying,g=d.lastInsertModeChanges,h=[];if(!f){for(var i=g.inVisualBlock?c.lastSelection.visualBlock.height:1,j=g.changes,h=[],k=0;k<j.length;)h.push(j[k]),j[k]instanceof Fb?k++:k+=i;g.changes=h,b.off("change",Bb),a.off(b.getInputField(),"keydown",Gb)}!f&&c.insertModeRepeat>1&&(Hb(b,c,c.insertModeRepeat-1,!0),c.lastEditInputState.repeatOverride=c.insertModeRepeat),delete c.insertModeRepeat,c.insertMode=!1,b.setCursor(b.getCursor().line,b.getCursor().ch-1),b.setOption("keyMap","vim"),b.setOption("disableInput",!0),b.toggleOverwrite(!1),e.setText(g.changes.join("")),a.signal(b,"vim-mode-change",{mode:"normal"}),d.isRecording&&zb(d)}function vb(a){b.unshift(a)}function wb(a,b,c,d,e){var f={keys:a,type:b};f[b]=c,f[b+"Args"]=d;for(var g in e)f[g]=e[g];vb(f)}function xb(b,c,d,e){var f=L.registerController.getRegister(e);if(":"==e)return f.keyBuffer[0]&&sb.processCommand(b,f.keyBuffer[0]),void(d.isPlaying=!1);var g=f.keyBuffer,h=0;d.isPlaying=!0,d.replaySearchQueries=f.searchQueries.slice(0);for(var i=0;i<g.length;i++)for(var k,l,j=g[i];j;)if(k=/<\w+-.+?>|<\w+>|./.exec(j),l=k[0],j=j.substring(k.index+l.length),a.Vim.handleKey(b,l,"macro"),c.insertMode){var m=f.insertModeChanges[h++].changes;L.macroModeState.lastInsertModeChanges.changes=m,Ib(b,m,1),ub(b)}d.isPlaying=!1}function yb(a,b){if(!a.isPlaying){var c=a.latestRegister,d=L.registerController.getRegister(c);d&&d.pushText(b)}}function zb(a){if(!a.isPlaying){var b=a.latestRegister,c=L.registerController.getRegister(b);c&&c.pushInsertModeChanges&&c.pushInsertModeChanges(a.lastInsertModeChanges)}}function Ab(a,b){if(!a.isPlaying){var c=a.latestRegister,d=L.registerController.getRegister(c);d&&d.pushSearchQuery&&d.pushSearchQuery(b)}}function Bb(a,b){var c=L.macroModeState,d=c.lastInsertModeChanges;if(!c.isPlaying)for(;b;){if(d.expectCursorActivityForChange=!0,"+input"==b.origin||"paste"==b.origin||void 0===b.origin){var e=b.text.join("\n");d.changes.push(e)}b=b.next}}function Cb(a){var b=a.state.vim;if(b.insertMode){var c=L.macroModeState;if(c.isPlaying)return;var d=c.lastInsertModeChanges;d.expectCursorActivityForChange?d.expectCursorActivityForChange=!1:d.changes=[]}else a.curOp.isVimOp||Eb(a,b);b.visualMode&&Db(a)}function Db(a){var b=a.state.vim,c=ba(a,ja(b.sel.head)),d=da(c,0,1);b.fakeCursor&&b.fakeCursor.clear(),b.fakeCursor=a.markText(c,d,{className:"cm-animate-fat-cursor"})}function Eb(b,c){var d=b.getCursor("anchor"),e=b.getCursor("head");if(c.visualMode&&!b.somethingSelected()?Ca(b,!1):c.visualMode||c.insertMode||!b.somethingSelected()||(c.visualMode=!0,c.visualLine=!1,a.signal(b,"vim-mode-change",{mode:"visual"})),c.visualMode){var f=la(e,d)?0:-1,g=la(e,d)?-1:0;e=da(e,0,f),d=da(d,0,g),c.sel={anchor:d,head:e},Qa(b,c,"<",ma(e,d)),Qa(b,c,">",na(e,d))}else c.insertMode||(c.lastHPos=b.getCursor().ch)}function Fb(a){this.keyName=a}function Gb(b){function f(){return d.changes.push(new Fb(e)),!0}var c=L.macroModeState,d=c.lastInsertModeChanges,e=a.keyName(b);e&&(-1!=e.indexOf("Delete")||-1!=e.indexOf("Backspace"))&&a.lookupKey(e,"vim-insert",f)}function Hb(a,b,c,d){function h(){f?V.processAction(a,b,b.lastEditActionCommand):V.evalInput(a,b)}function i(c){if(e.lastInsertModeChanges.changes.length>0){c=b.lastEditActionCommand?c:1;var d=e.lastInsertModeChanges;Ib(a,d.changes,c)}}var e=L.macroModeState;e.isPlaying=!0;var f=!!b.lastEditActionCommand,g=b.inputState;if(b.inputState=b.lastEditInputState,f&&b.lastEditActionCommand.interlaceInsertRepeat)for(var j=0;c>j;j++)h(),i(1);else d||h(),i(c);b.inputState=g,b.insertMode&&!d&&ub(a),e.isPlaying=!1}function Ib(b,c,d){function e(c){return"string"==typeof c?a.commands[c](b):c(b),!0}var f=b.getCursor("head"),g=L.macroModeState.lastInsertModeChanges.inVisualBlock;if(g){var h=b.state.vim,i=h.lastSelection,j=ea(i.anchor,i.head);ua(b,f,j.line+1),d=b.listSelections().length,b.setCursor(f)}for(var k=0;d>k;k++){g&&b.setCursor(da(f,k,0));for(var l=0;l<c.length;l++){var m=c[l];if(m instanceof Fb)a.lookupKey(m.keyName,"vim-insert",e);else{var n=b.getCursor();b.replaceRange(m,n,n)}}}g&&b.setCursor(da(f,0,1))}a.defineOption("vimMode",!1,function(b,c,d){c&&"vim"!=b.getOption("keyMap")?b.setOption("keyMap","vim"):!c&&d!=a.Init&&/^vim/.test(b.getOption("keyMap"))&&b.setOption("keyMap","default")});var j={Shift:"S",Ctrl:"C",Alt:"A",Cmd:"D",Mod:"A"},k={Enter:"CR",Backspace:"BS",Delete:"Del"},n=/[\d]/,o=[a.isWordChar,function(b){return b&&!a.isWordChar(b)&&!/\s/.test(b)}],p=[function(a){return/\S/.test(a)}],r=q(65,26),s=q(97,26),t=q(48,10),u=[].concat(r,s,t,["<",">"]),v=[].concat(r,s,t,["-",'"',".",":","/"]),D={};E("filetype",void 0,"string",["ft"],function(a,b){if(void 0!==b){if(void 0===a){var c=b.getOption("mode");return"null"==c?"":c}var c=""==a?"null":a;b.setOption("mode",c)}});var H=function(){function f(f,g,h){function k(c){var d=++b%a,g=e[d];g&&g.clear(),e[d]=f.setBookmark(c)}var i=b%a,j=e[i];if(j){var l=j.find();l&&!ka(l,g)&&k(g)}else k(g);k(h),c=b,d=b-a+1,0>d&&(d=0)}function g(f,g){b+=g,b>c?b=c:d>b&&(b=d);var h=e[(a+b)%a];if(h&&!h.find()){var j,i=g>0?1:-1,k=f.getCursor();do if(b+=i,h=e[(a+b)%a],h&&(j=h.find())&&!ka(k,j))break;while(c>b&&b>d)}return h}var a=100,b=-1,c=0,d=0,e=new Array(a);return{cachedCursor:void 0,add:f,move:g}},I=function(a){return a?{changes:a.changes,expectCursorActivityForChange:a.expectCursorActivityForChange}:{changes:[],expectCursorActivityForChange:!1}};J.prototype={exitMacroRecordMode:function(){var a=L.macroModeState;a.onRecordingDone&&a.onRecordingDone(),a.onRecordingDone=void 0,a.isRecording=!1},enterMacroRecordMode:function(a,b){var c=L.registerController.getRegister(b);c&&(c.clear(),this.latestRegister=b,a.openDialog&&(this.onRecordingDone=a.openDialog("(recording)["+b+"]",null,{bottom:!0})),this.isRecording=!0)}};var L,N,O={buildKeyMap:function(){},getRegisterController:function(){return L.registerController},resetVimGlobalState_:M,getVimGlobalState_:function(){return L},maybeInitVimState_:K,suppressErrorLogging:!1,InsertModeKey:Fb,map:function(a,b,c){sb.map(a,b,c)},unmap:function(a,b){sb.unmap(a,b)},setOption:F,getOption:G,defineOption:E,defineEx:function(a,b,c){if(b){if(0!==a.indexOf(b))throw new Error('(Vim.defineEx) "'+b+'" is not a prefix of "'+a+'", command not registered')}else b=a;rb[a]=c,sb.commandMap_[b]={name:a,shortName:b,type:"api"}},handleKey:function(a,b,c){var d=this.findKey(a,b,c);return"function"==typeof d?d():void 0},findKey:function(c,d,e){function g(){var a=L.macroModeState;if(a.isRecording){if("q"==d)return a.exitMacroRecordMode(),Q(c),!0;"mapping"!=e&&yb(a,d)}}function h(){return"<Esc>"==d?(Q(c),f.visualMode?Ca(c):f.insertMode&&ub(c),!0):void 0}function i(b){for(var e;b;)e=/<\w+-.+?>|<\w+>|./.exec(b),d=e[0],b=b.substring(e.index+d.length),a.Vim.handleKey(c,d,"mapping")}function j(){if(h())return!0;for(var a=f.inputState.keyBuffer=f.inputState.keyBuffer+d,e=1==d.length,g=V.matchCommand(a,b,f.inputState,"insert");a.length>1&&"full"!=g.type;){var a=f.inputState.keyBuffer=a.slice(1),i=V.matchCommand(a,b,f.inputState,"insert");"none"!=i.type&&(g=i)}if("none"==g.type)return Q(c),!1;if("partial"==g.type)return N&&window.clearTimeout(N),N=window.setTimeout(function(){f.insertMode&&f.inputState.keyBuffer&&Q(c)},G("insertModeEscKeysTimeout")),!e;if(N&&window.clearTimeout(N),e){var j=c.getCursor();c.replaceRange("",da(j,0,-(a.length-1)),j,"+input")}return Q(c),g.command}function k(){if(g()||h())return!0;var a=f.inputState.keyBuffer=f.inputState.keyBuffer+d;if(/^[1-9]\d*$/.test(a))return!0;var e=/^(\d*)(.*)$/.exec(a);if(!e)return Q(c),!1;var i=f.visualMode?"visual":"normal",j=V.matchCommand(e[2]||e[1],b,f.inputState,i);if("none"==j.type)return Q(c),!1;if("partial"==j.type)return!0;f.inputState.keyBuffer="";var e=/^(\d*)(.*)$/.exec(a);return e[1]&&"0"!=e[1]&&f.inputState.pushRepeatDigit(e[1]),j.command}var l,f=K(c);return l=f.insertMode?j():k(),l===!1?void 0:l===!0?function(){}:function(){return c.operation(function(){c.curOp.isVimOp=!0;try{"keyToKey"==l.type?i(l.toKeys):V.processCommand(c,f,l)}catch(b){throw c.state.vim=void 0,K(c),a.Vim.suppressErrorLogging||console.log(b),b}return!0})}},handleEx:function(a,b){sb.processCommand(a,b)},defineMotion:X,defineAction:aa,defineOperator:$,mapCommand:wb,_mapCommand:vb,defineRegister:S,exitVisualMode:Ca,exitInsertMode:ub};P.prototype.pushRepeatDigit=function(a){this.operator?this.motionRepeat=this.motionRepeat.concat(a):this.prefixRepeat=this.prefixRepeat.concat(a)},P.prototype.getRepeat=function(){var a=0;return(this.prefixRepeat.length>0||this.motionRepeat.length>0)&&(a=1,this.prefixRepeat.length>0&&(a*=parseInt(this.prefixRepeat.join(""),10)),this.motionRepeat.length>0&&(a*=parseInt(this.motionRepeat.join(""),10))),a},R.prototype={setText:function(a,b,c){this.keyBuffer=[a||""],this.linewise=!!b,this.blockwise=!!c},pushText:function(a,b){b&&(this.linewise||this.keyBuffer.push("\n"),this.linewise=!0),this.keyBuffer.push(a)},pushInsertModeChanges:function(a){this.insertModeChanges.push(I(a))},pushSearchQuery:function(a){this.searchQueries.push(a)},clear:function(){this.keyBuffer=[],this.insertModeChanges=[],this.searchQueries=[],this.linewise=!1},toString:function(){return this.keyBuffer.join("")}},T.prototype={pushText:function(a,b,c,d,e){d&&"\n"==c.charAt(0)&&(c=c.slice(1)+"\n"),d&&"\n"!==c.charAt(c.length-1)&&(c+="\n");var f=this.isValidRegister(a)?this.getRegister(a):null;if(!f){switch(b){case"yank":this.registers[0]=new R(c,d,e);break;case"delete":case"change":-1==c.indexOf("\n")?this.registers["-"]=new R(c,d):(this.shiftNumericRegisters_(),this.registers[1]=new R(c,d))}return void this.unnamedRegister.setText(c,d,e)}var g=A(a);g?f.pushText(c,d):f.setText(c,d,e),this.unnamedRegister.setText(f.toString(),d)},getRegister:function(a){return this.isValidRegister(a)?(a=a.toLowerCase(),this.registers[a]||(this.registers[a]=new R),this.registers[a]):this.unnamedRegister},isValidRegister:function(a){return a&&C(a,v)},shiftNumericRegisters_:function(){for(var a=9;a>=2;a--)this.registers[a]=this.getRegister(""+(a-1))}},U.prototype={nextMatch:function(a,b){var c=this.historyBuffer,d=b?-1:1;null===this.initialPrefix&&(this.initialPrefix=a);for(var e=this.iterator+d;b?e>=0:e<c.length;e+=d)for(var f=c[e],g=0;g<=f.length;g++)if(this.initialPrefix==f.substring(0,g))return this.iterator=e,f;return e>=c.length?(this.iterator=c.length,this.initialPrefix):0>e?a:void 0},pushInput:function(a){var b=this.historyBuffer.indexOf(a);b>-1&&this.historyBuffer.splice(b,1),a.length&&this.historyBuffer.push(a)},reset:function(){this.initialPrefix=null,this.iterator=this.historyBuffer.length}};var V={matchCommand:function(a,b,c,d){var e=fa(a,b,d,c);if(!e.full&&!e.partial)return{type:"none"};if(!e.full&&e.partial)return{type:"partial"};for(var f,g=0;g<e.full.length;g++){var h=e.full[g];f||(f=h)}return"<character>"==f.keys.slice(-11)&&(c.selectedCharacter=ha(a)),{type:"full",command:f}},processCommand:function(a,b,c){switch(b.inputState.repeatOverride=c.repeatOverride,c.type){case"motion":this.processMotion(a,b,c);break;case"operator":this.processOperator(a,b,c);break;case"operatorMotion":this.processOperatorMotion(a,b,c);break;case"action":this.processAction(a,b,c);break;case"search":this.processSearch(a,b,c);break;case"ex":case"keyToEx":this.processEx(a,b,c)}},processMotion:function(a,b,c){b.inputState.motion=c.motion,b.inputState.motionArgs=ca(c.motionArgs),this.evalInput(a,b)},processOperator:function(a,b,c){var d=b.inputState;if(d.operator){if(d.operator==c.operator)return d.motion="expandToLine",d.motionArgs={linewise:!0},void this.evalInput(a,b);Q(a)}d.operator=c.operator,d.operatorArgs=ca(c.operatorArgs),b.visualMode&&this.evalInput(a,b)},processOperatorMotion:function(a,b,c){var d=b.visualMode,e=ca(c.operatorMotionArgs);e&&d&&e.visualLine&&(b.visualLine=!0),this.processOperator(a,b,c),d||this.processMotion(a,b,c)},processAction:function(a,b,c){var d=b.inputState,e=d.getRepeat(),f=!!e,g=ca(c.actionArgs)||{};d.selectedCharacter&&(g.selectedCharacter=d.selectedCharacter),c.operator&&this.processOperator(a,b,c),c.motion&&this.processMotion(a,b,c),(c.motion||c.operator)&&this.evalInput(a,b),g.repeat=e||1,g.repeatIsExplicit=f,g.registerName=d.registerName,Q(a),b.lastMotion=null,c.isEdit&&this.recordLastEdit(b,d,c),_[c.action](a,g,b)},processSearch:function(b,c,d){function j(a,e,f){L.searchHistoryController.pushInput(a),L.searchHistoryController.reset();try{jb(b,a,e,f)}catch(g){return eb(b,"Invalid regex: "+a),void Q(b)}V.processMotion(b,c,{type:"motion",motion:"findNext",motionArgs:{forward:!0,toJumplist:d.searchArgs.toJumplist}})}function k(a){b.scrollTo(i.left,i.top),j(a,!0,!0);var c=L.macroModeState;c.isRecording&&Ab(c,a)}function l(c,d,f){var h,g=a.keyName(c);"Up"==g||"Down"==g?(h="Up"==g?!0:!1,d=L.searchHistoryController.nextMatch(d,h)||"",f(d)):"Left"!=g&&"Right"!=g&&"Ctrl"!=g&&"Alt"!=g&&"Shift"!=g&&L.searchHistoryController.reset();var j;try{j=jb(b,d,!0,!0)}catch(c){}j?b.scrollIntoView(mb(b,!e,j),30):(nb(b),b.scrollTo(i.left,i.top))}function m(c,d,e){var f=a.keyName(c);"Esc"==f||"Ctrl-C"==f||"Ctrl-["==f||"Backspace"==f&&""==d?(L.searchHistoryController.pushInput(d),L.searchHistoryController.reset(),jb(b,h),nb(b),b.scrollTo(i.left,i.top),a.e_stop(c),Q(b),e(),b.focus()):"Ctrl-U"==f&&(a.e_stop(c),e(""))}if(b.getSearchCursor){var e=d.searchArgs.forward,f=d.searchArgs.wholeWordOnly;Wa(b).setReversed(!e);var g=e?"/":"?",h=Wa(b).getQuery(),i=b.getScrollInfo();switch(d.searchArgs.querySrc){case"prompt":var n=L.macroModeState;if(n.isPlaying){var o=n.replaySearchQueries.shift();j(o,!0,!1)}else hb(b,{onClose:k,prefix:g,desc:gb,onKeyUp:l,onKeyDown:m});break;case"wordUnderCursor":var p=Ga(b,!1,!0,!1,!0),q=!0;if(p||(p=Ga(b,!1,!0,!1,!1),q=!1),!p)return;var o=b.getLine(p.start.line).substring(p.start.ch,p.end.ch);o=q&&f?"\\b"+o+"\\b":ra(o),L.jumpList.cachedCursor=b.getCursor(),b.setCursor(p.start),j(o,!0,!1)}}},processEx:function(b,c,d){function e(a){L.exCommandHistoryController.pushInput(a),L.exCommandHistoryController.reset(),sb.processCommand(b,a)}function f(c,d,e){var g,f=a.keyName(c);("Esc"==f||"Ctrl-C"==f||"Ctrl-["==f||"Backspace"==f&&""==d)&&(L.exCommandHistoryController.pushInput(d),L.exCommandHistoryController.reset(),a.e_stop(c),Q(b),e(),b.focus()),"Up"==f||"Down"==f?(g="Up"==f?!0:!1,d=L.exCommandHistoryController.nextMatch(d,g)||"",e(d)):"Ctrl-U"==f?(a.e_stop(c),e("")):"Left"!=f&&"Right"!=f&&"Ctrl"!=f&&"Alt"!=f&&"Shift"!=f&&L.exCommandHistoryController.reset()}"keyToEx"==d.type?sb.processCommand(b,d.exArgs.input):c.visualMode?hb(b,{onClose:e,prefix:":",value:"'<,'>",onKeyDown:f}):hb(b,{onClose:e,prefix:":",onKeyDown:f})},evalInput:function(a,b){var o,p,q,c=b.inputState,e=c.motion,f=c.motionArgs||{},g=c.operator,h=c.operatorArgs||{},i=c.registerName,j=b.sel,k=ja(b.visualMode?ba(a,j.head):a.getCursor("head")),l=ja(b.visualMode?ba(a,j.anchor):a.getCursor("anchor")),m=ja(k),n=ja(l);
if(g&&this.recordLastEdit(b,c),q=void 0!==c.repeatOverride?c.repeatOverride:c.getRepeat(),q>0&&f.explicitRepeat?f.repeatIsExplicit=!0:(f.noRepeat||!f.explicitRepeat&&0===q)&&(q=1,f.repeatIsExplicit=!1),c.selectedCharacter&&(f.selectedCharacter=h.selectedCharacter=c.selectedCharacter),f.repeat=q,Q(a),e){var r=W[e](a,k,f,b);if(b.lastMotion=W[e],!r)return;if(f.toJumplist){var s=L.jumpList,t=s.cachedCursor;t?(Ha(a,t,r),delete s.cachedCursor):Ha(a,k,r)}r instanceof Array?(p=r[0],o=r[1]):o=r,o||(o=ja(k)),b.visualMode?(b.visualBlock&&o.ch===1/0||(o=ba(a,o,b.visualBlock)),p&&(p=ba(a,p,!0)),p=p||n,j.anchor=p,j.head=o,za(a),Qa(a,b,"<",la(p,o)?p:o),Qa(a,b,">",la(p,o)?o:p)):g||(o=ba(a,o),a.setCursor(o.line,o.ch))}if(g){if(h.lastSel){p=n;var u=h.lastSel,v=Math.abs(u.head.line-u.anchor.line),w=Math.abs(u.head.ch-u.anchor.ch);o=u.visualLine?d(n.line+v,n.ch):u.visualBlock?d(n.line+v,n.ch+w):u.head.line==u.anchor.line?d(n.line,n.ch+w):d(n.line+v,n.ch),b.visualMode=!0,b.visualLine=u.visualLine,b.visualBlock=u.visualBlock,j=b.sel={anchor:p,head:o},za(a)}else b.visualMode&&(h.lastSel={anchor:ja(j.anchor),head:ja(j.head),visualBlock:b.visualBlock,visualLine:b.visualLine});var x,y,z,A,B;if(b.visualMode){if(x=ma(j.head,j.anchor),y=na(j.head,j.anchor),z=b.visualLine||h.linewise,A=b.visualBlock?"block":z?"line":"char",B=Aa(a,{anchor:x,head:y},A),z){var C=B.ranges;if("block"==A)for(var D=0;D<C.length;D++)C[D].head.ch=pa(a,C[D].head.line);else"line"==A&&(C[0].head=d(C[0].head.line+1,0))}}else{if(x=ja(p||n),y=ja(o||m),la(y,x)){var E=x;x=y,y=E}z=f.linewise||h.linewise,z?Ea(a,x,y):f.forward&&Da(a,x,y),A="char";var F=!f.inclusive||z;B=Aa(a,{anchor:x,head:y},A,F)}a.setSelections(B.ranges,B.primary),b.lastMotion=null,h.repeat=q,h.registerName=i,h.linewise=z;var G=Z[g](a,h,B.ranges,n,o);b.visualMode&&Ca(a,null!=G),G&&a.setCursor(G)}},recordLastEdit:function(a,b,c){var d=L.macroModeState;d.isPlaying||(a.lastEditInputState=b,a.lastEditActionCommand=c,d.lastInsertModeChanges.changes=[],d.lastInsertModeChanges.expectCursorActivityForChange=!1)}},W={moveToTopLine:function(a,b,c){var e=pb(a).top+c.repeat-1;return d(e,Fa(a.getLine(e)))},moveToMiddleLine:function(a){var b=pb(a),c=Math.floor(.5*(b.top+b.bottom));return d(c,Fa(a.getLine(c)))},moveToBottomLine:function(a,b,c){var e=pb(a).bottom-c.repeat+1;return d(e,Fa(a.getLine(e)))},expandToLine:function(a,b,c){var e=b;return d(e.line+c.repeat-1,1/0)},findNext:function(a,b,c){var d=Wa(a),e=d.getQuery();if(e){var f=!c.forward;return f=d.isReversed()?!f:f,lb(a,e),mb(a,f,e,c.repeat)}},goToMark:function(a,b,c,d){var e=d.marks[c.selectedCharacter];if(e){var f=e.find();return c.linewise?{line:f.line,ch:Fa(a.getLine(f.line))}:f}return null},moveToOtherHighlightedEnd:function(a,b,c,e){if(e.visualBlock&&c.sameLine){var f=e.sel;return[ba(a,d(f.anchor.line,f.head.ch)),ba(a,d(f.head.line,f.anchor.ch))]}return[e.sel.head,e.sel.anchor]},jumpToMark:function(a,b,c,e){for(var f=b,g=0;g<c.repeat;g++){var h=f;for(var i in e.marks)if(x(i)){var j=e.marks[i].find(),k=c.forward?la(j,h):la(h,j);if(!(k||c.linewise&&j.line==h.line)){var l=ka(h,f),m=c.forward?oa(h,j,f):oa(f,j,h);(l||m)&&(f=j)}}}return c.linewise&&(f=d(f.line,Fa(a.getLine(f.line)))),f},moveByCharacters:function(a,b,c){var e=b,f=c.repeat,g=c.forward?e.ch+f:e.ch-f;return d(e.line,g)},moveByLines:function(a,b,c,e){var f=b,g=f.ch;switch(e.lastMotion){case this.moveByLines:case this.moveByDisplayLines:case this.moveByScroll:case this.moveToColumn:case this.moveToEol:g=e.lastHPos;break;default:e.lastHPos=g}var h=c.repeat+(c.repeatOffset||0),i=c.forward?f.line+h:f.line-h,j=a.firstLine(),k=a.lastLine();return j>i&&f.line==j?this.moveToStartOfLine(a,b,c,e):i>k&&f.line==k?this.moveToEol(a,b,c,e):(c.toFirstChar&&(g=Fa(a.getLine(i)),e.lastHPos=g),e.lastHSPos=a.charCoords(d(i,g),"div").left,d(i,g))},moveByDisplayLines:function(a,b,c,e){var f=b;switch(e.lastMotion){case this.moveByDisplayLines:case this.moveByScroll:case this.moveByLines:case this.moveToColumn:case this.moveToEol:break;default:e.lastHSPos=a.charCoords(f,"div").left}var g=c.repeat,h=a.findPosV(f,c.forward?g:-g,"line",e.lastHSPos);if(h.hitSide)if(c.forward)var i=a.charCoords(h,"div"),j={top:i.top+8,left:e.lastHSPos},h=a.coordsChar(j,"div");else{var k=a.charCoords(d(a.firstLine(),0),"div");k.left=e.lastHSPos,h=a.coordsChar(k,"div")}return e.lastHPos=h.ch,h},moveByPage:function(a,b,c){var d=b,e=c.repeat;return a.findPosV(d,c.forward?e:-e,"page")},moveByParagraph:function(a,b,c){var d=c.forward?1:-1;return Sa(a,b,c.repeat,d)},moveByScroll:function(a,b,c,d){var e=a.getScrollInfo(),f=null,g=c.repeat;g||(g=e.clientHeight/(2*a.defaultTextHeight()));var h=a.charCoords(b,"local");c.repeat=g;var f=W.moveByDisplayLines(a,b,c,d);if(!f)return null;var i=a.charCoords(f,"local");return a.scrollTo(null,e.top+i.top-h.top),f},moveByWords:function(a,b,c){return Na(a,b,c.repeat,!!c.forward,!!c.wordEnd,!!c.bigWord)},moveTillCharacter:function(a,b,c){var d=c.repeat,e=Oa(a,d,c.forward,c.selectedCharacter),f=c.forward?-1:1;return Ia(f,c),e?(e.ch+=f,e):null},moveToCharacter:function(a,b,c){var d=c.repeat;return Ia(0,c),Oa(a,d,c.forward,c.selectedCharacter)||b},moveToSymbol:function(a,b,c){var d=c.repeat;return La(a,d,c.forward,c.selectedCharacter)||b},moveToColumn:function(a,b,c,d){var e=c.repeat;return d.lastHPos=e-1,d.lastHSPos=a.charCoords(b,"div").left,Pa(a,e)},moveToEol:function(a,b,c,e){var f=b;e.lastHPos=1/0;var g=d(f.line+c.repeat-1,1/0),h=a.clipPos(g);return h.ch--,e.lastHSPos=a.charCoords(h,"div").left,g},moveToFirstNonWhiteSpaceCharacter:function(a,b){var c=b;return d(c.line,Fa(a.getLine(c.line)))},moveToMatchedSymbol:function(a,b){var h,c=b,e=c.line,f=c.ch,g=a.getLine(e);do if(h=g.charAt(f++),h&&y(h)){var i=a.getTokenTypeAt(d(e,f));if("string"!==i&&"comment"!==i)break}while(h);if(h){var j=a.findMatchingBracket(d(e,f));return j.to}return c},moveToStartOfLine:function(a,b){return d(b.line,0)},moveToLineOrEdgeOfDocument:function(a,b,c){var e=c.forward?a.lastLine():a.firstLine();return c.repeatIsExplicit&&(e=c.repeat-a.getOption("firstLineNumber")),d(e,Fa(a.getLine(e)))},textObjectManipulation:function(a,b,c,d){var e={"(":")",")":"(","{":"}","}":"{","[":"]","]":"["},f={"'":!0,'"':!0},g=c.selectedCharacter;"b"==g?g="(":"B"==g&&(g="{");var i,h=!c.textObjectInner;if(e[g])i=Ta(a,b,g,h);else if(f[g])i=Ua(a,b,g,h);else if("W"===g)i=Ga(a,h,!0,!0);else if("w"===g)i=Ga(a,h,!0,!1);else{if("p"!==g)return null;if(i=Sa(a,b,c.repeat,0,h),c.linewise=!0,d.visualMode)d.visualLine||(d.visualLine=!0);else{var j=d.inputState.operatorArgs;j&&(j.linewise=!0),i.end.line--}}return a.state.vim.visualMode?ya(a,i.start,i.end):[i.start,i.end]},repeatLastCharacterSearch:function(a,b,c){var d=L.lastCharacterSearch,e=c.repeat,f=c.forward===d.forward,g=(d.increment?1:0)*(f?-1:1);a.moveH(-g,"char"),c.inclusive=f?!0:!1;var h=Oa(a,e,f,d.selectedCharacter);return h?(h.ch+=g,h):(a.moveH(g,"char"),b)}},Z={change:function(b,c,e){var f,g,h=b.state.vim;if(L.macroModeState.lastInsertModeChanges.inVisualBlock=h.visualBlock,h.visualMode){g=b.getSelection();var o=Y("",e.length);b.replaceSelections(o),f=ma(e[0].head,e[0].anchor)}else{var i=e[0].anchor,j=e[0].head;g=b.getRange(i,j);var k=h.lastEditInputState||{};if("moveByWords"==k.motion&&!B(g)){var l=/\s+$/.exec(g);l&&k.motionArgs&&k.motionArgs.forward&&(j=da(j,0,-l[0].length),g=g.slice(0,-l[0].length))}var m=new d(i.line-1,Number.MAX_VALUE),n=b.firstLine()==b.lastLine();j.line>b.lastLine()&&c.linewise&&!n?b.replaceRange("",m,j):b.replaceRange("",i,j),c.linewise&&(n||(b.setCursor(m),a.commands.newlineAndIndent(b)),i.ch=Number.MAX_VALUE),f=i}L.registerController.pushText(c.registerName,"change",g,c.linewise,e.length>1),_.enterInsertMode(b,{head:f},b.state.vim)},"delete":function(a,b,c){var e,f,g=a.state.vim;if(g.visualBlock){f=a.getSelection();var j=Y("",c.length);a.replaceSelections(j),e=c[0].anchor}else{var h=c[0].anchor,i=c[0].head;b.linewise&&i.line!=a.firstLine()&&h.line==a.lastLine()&&h.line==i.line-1&&(h.line==a.firstLine()?h.ch=0:h=d(h.line-1,pa(a,h.line-1))),f=a.getRange(h,i),a.replaceRange("",h,i),e=h,b.linewise&&(e=W.moveToFirstNonWhiteSpaceCharacter(a,h))}return L.registerController.pushText(b.registerName,"delete",f,b.linewise,g.visualBlock),ba(a,e)},indent:function(a,b,c){var d=a.state.vim,e=c[0].anchor.line,f=d.visualBlock?c[c.length-1].anchor.line:c[0].head.line,g=d.visualMode?b.repeat:1;b.linewise&&f--;for(var h=e;f>=h;h++)for(var i=0;g>i;i++)a.indentLine(h,b.indentRight);return W.moveToFirstNonWhiteSpaceCharacter(a,c[0].anchor)},changeCase:function(a,b,c,d,e){for(var f=a.getSelections(),g=[],h=b.toLower,i=0;i<f.length;i++){var j=f[i],k="";if(h===!0)k=j.toLowerCase();else if(h===!1)k=j.toUpperCase();else for(var l=0;l<j.length;l++){var m=j.charAt(l);k+=A(m)?m.toLowerCase():m.toUpperCase()}g.push(k)}return a.replaceSelections(g),b.shouldMoveCursor?e:!a.state.vim.visualMode&&b.linewise&&c[0].anchor.line+1==c[0].head.line?W.moveToFirstNonWhiteSpaceCharacter(a,d):b.linewise?d:ma(c[0].anchor,c[0].head)},yank:function(a,b,c,d){var e=a.state.vim,f=a.getSelection(),g=e.visualMode?ma(e.sel.anchor,e.sel.head,c[0].head,c[0].anchor):d;return L.registerController.pushText(b.registerName,"yank",f,b.linewise,e.visualBlock),g}},_={jumpListWalk:function(a,b,c){if(!c.visualMode){var d=b.repeat,e=b.forward,f=L.jumpList,g=f.move(a,e?d:-d),h=g?g.find():void 0;h=h?h:a.getCursor(),a.setCursor(h)}},scroll:function(a,b,c){if(!c.visualMode){var d=b.repeat||1,e=a.defaultTextHeight(),f=a.getScrollInfo().top,g=e*d,h=b.forward?f+g:f-g,i=ja(a.getCursor()),j=a.charCoords(i,"local");if(b.forward)h>j.top?(i.line+=(h-j.top)/e,i.line=Math.ceil(i.line),a.setCursor(i),j=a.charCoords(i,"local"),a.scrollTo(null,j.top)):a.scrollTo(null,h);else{var k=h+a.getScrollInfo().clientHeight;k<j.bottom?(i.line-=(j.bottom-k)/e,i.line=Math.floor(i.line),a.setCursor(i),j=a.charCoords(i,"local"),a.scrollTo(null,j.bottom-a.getScrollInfo().clientHeight)):a.scrollTo(null,h)}}},scrollToCursor:function(a,b){var c=a.getCursor().line,e=a.charCoords(d(c,0),"local"),f=a.getScrollInfo().clientHeight,g=e.top,h=e.bottom-g;switch(b.position){case"center":g=g-f/2+h;break;case"bottom":g=g-f+h}a.scrollTo(null,g)},replayMacro:function(a,b,c){var d=b.selectedCharacter,e=b.repeat,f=L.macroModeState;for("@"==d&&(d=f.latestRegister);e--;)xb(a,c,f,d)},enterMacroRecordMode:function(a,b){var c=L.macroModeState,d=b.selectedCharacter;c.enterMacroRecordMode(a,d)},enterInsertMode:function(b,c,e){if(!b.getOption("readOnly")){e.insertMode=!0,e.insertModeRepeat=c&&c.repeat||1;var f=c?c.insertAt:null,g=e.sel,h=c.head||b.getCursor("head"),i=b.listSelections().length;if("eol"==f)h=d(h.line,pa(b,h.line));else if("charAfter"==f)h=da(h,0,1);else if("firstNonBlank"==f)h=W.moveToFirstNonWhiteSpaceCharacter(b,h);else if("startOfSelectedArea"==f)e.visualBlock?(h=d(Math.min(g.head.line,g.anchor.line),Math.min(g.head.ch,g.anchor.ch)),i=Math.abs(g.head.line-g.anchor.line)+1):h=g.head.line<g.anchor.line?g.head:d(g.anchor.line,0);else if("endOfSelectedArea"==f)e.visualBlock?(h=d(Math.min(g.head.line,g.anchor.line),Math.max(g.head.ch+1,g.anchor.ch)),i=Math.abs(g.head.line-g.anchor.line)+1):h=g.head.line>=g.anchor.line?da(g.head,0,1):d(g.anchor.line,0);else if("inplace"==f&&e.visualMode)return;b.setOption("keyMap","vim-insert"),b.setOption("disableInput",!1),c&&c.replace?(b.toggleOverwrite(!0),b.setOption("keyMap","vim-replace"),a.signal(b,"vim-mode-change",{mode:"replace"})):(b.setOption("keyMap","vim-insert"),a.signal(b,"vim-mode-change",{mode:"insert"})),L.macroModeState.isPlaying||(b.on("change",Bb),a.on(b.getInputField(),"keydown",Gb)),e.visualMode&&Ca(b),ua(b,h,i)}},toggleVisualMode:function(b,c,e){var h,f=c.repeat,g=b.getCursor();e.visualMode?e.visualLine^c.linewise||e.visualBlock^c.blockwise?(e.visualLine=!!c.linewise,e.visualBlock=!!c.blockwise,a.signal(b,"vim-mode-change",{mode:"visual",subMode:e.visualLine?"linewise":e.visualBlock?"blockwise":""}),za(b)):Ca(b):(e.visualMode=!0,e.visualLine=!!c.linewise,e.visualBlock=!!c.blockwise,h=ba(b,d(g.line,g.ch+f-1),!0),e.sel={anchor:g,head:h},a.signal(b,"vim-mode-change",{mode:"visual",subMode:e.visualLine?"linewise":e.visualBlock?"blockwise":""}),za(b),Qa(b,e,"<",ma(g,h)),Qa(b,e,">",na(g,h)))},reselectLastSelection:function(b,c,d){var e=d.lastSelection;if(d.visualMode&&xa(b,d),e){var f=e.anchorMark.find(),g=e.headMark.find();if(!f||!g)return;d.sel={anchor:f,head:g},d.visualMode=!0,d.visualLine=e.visualLine,d.visualBlock=e.visualBlock,za(b),Qa(b,d,"<",ma(f,g)),Qa(b,d,">",na(f,g)),a.signal(b,"vim-mode-change",{mode:"visual",subMode:d.visualLine?"linewise":d.visualBlock?"blockwise":""})}},joinLines:function(a,b,c){var e,f;if(c.visualMode){if(e=a.getCursor("anchor"),f=a.getCursor("head"),la(f,e)){var g=f;f=e,e=g}f.ch=pa(a,f.line)-1}else{var h=Math.max(b.repeat,2);e=a.getCursor(),f=ba(a,d(e.line+h-1,1/0))}for(var i=0,j=e.line;j<f.line;j++){i=pa(a,e.line);var g=d(e.line+1,pa(a,e.line+1)),k=a.getRange(e,g);k=k.replace(/\n\s*/g," "),a.replaceRange(k,e,g)}var l=d(e.line,i);c.visualMode&&Ca(a,!1),a.setCursor(l)},newLineAndEnterInsertMode:function(b,c,e){e.insertMode=!0;var f=ja(b.getCursor());if(f.line!==b.firstLine()||c.after){f.line=c.after?f.line:f.line-1,f.ch=pa(b,f.line),b.setCursor(f);var g=a.commands.newlineAndIndentContinueComment||a.commands.newlineAndIndent;g(b)}else b.replaceRange("\n",d(b.firstLine(),0)),b.setCursor(b.firstLine(),0);this.enterInsertMode(b,{repeat:c.repeat},e)},paste:function(a,b,c){var e=ja(a.getCursor()),f=L.registerController.getRegister(b.registerName),g=f.toString();if(g){if(b.matchIndent){var h=a.getOption("tabSize"),i=function(a){var b=a.split("	").length-1,c=a.split(" ").length-1;return b*h+1*c},j=a.getLine(a.getCursor().line),k=i(j.match(/^\s*/)[0]),l=g.replace(/\n$/,""),m=g!==l,n=i(g.match(/^\s*/)[0]),g=l.replace(/^\s*/gm,function(b){var c=k+(i(b)-n);if(0>c)return"";if(a.getOption("indentWithTabs")){var d=Math.floor(c/h);return Array(d+1).join("	")}return Array(c+1).join(" ")});g+=m?"\n":""}if(b.repeat>1)var g=Array(b.repeat+1).join(g);var o=f.linewise,p=f.blockwise;if(o)c.visualMode?g=c.visualLine?g.slice(0,-1):"\n"+g.slice(0,g.length-1)+"\n":b.after?(g="\n"+g.slice(0,g.length-1),e.ch=pa(a,e.line)):e.ch=0;else{if(p){g=g.split("\n");for(var q=0;q<g.length;q++)g[q]=""==g[q]?" ":g[q]}e.ch+=b.after?1:0}var r,s;if(c.visualMode){c.lastPastedText=g;var t,u=wa(a,c),v=u[0],w=u[1],x=a.getSelection(),y=a.listSelections(),z=new Array(y.length).join("1").split("1");c.lastSelection&&(t=c.lastSelection.headMark.find()),L.registerController.unnamedRegister.setText(x),p?(a.replaceSelections(z),w=d(v.line+g.length-1,v.ch),a.setCursor(v),ta(a,w),a.replaceSelections(g),r=v):c.visualBlock?(a.replaceSelections(z),a.setCursor(v),a.replaceRange(g,v,v),r=v):(a.replaceRange(g,v,w),r=a.posFromIndex(a.indexFromPos(v)+g.length-1)),t&&(c.lastSelection.headMark=a.setBookmark(t)),o&&(r.ch=0)}else if(p){a.setCursor(e);for(var q=0;q<g.length;q++){var A=e.line+q;A>a.lastLine()&&a.replaceRange("\n",d(A,0));var B=pa(a,A);B<e.ch&&sa(a,A,e.ch)}a.setCursor(e),ta(a,d(e.line+g.length-1,e.ch)),a.replaceSelections(g),r=e}else a.replaceRange(g,e),o&&b.after?r=d(e.line+1,Fa(a.getLine(e.line+1))):o&&!b.after?r=d(e.line,Fa(a.getLine(e.line))):!o&&b.after?(s=a.indexFromPos(e),r=a.posFromIndex(s+g.length-1)):(s=a.indexFromPos(e),r=a.posFromIndex(s+g.length));c.visualMode&&Ca(a,!1),a.setCursor(r)}},undo:function(b,c){b.operation(function(){ia(b,a.commands.undo,c.repeat)(),b.setCursor(b.getCursor("anchor"))})},redo:function(b,c){ia(b,a.commands.redo,c.repeat)()},setRegister:function(a,b,c){c.inputState.registerName=b.selectedCharacter},setMark:function(a,b,c){var d=b.selectedCharacter;Qa(a,c,d,a.getCursor())},replace:function(b,c,e){var h,i,f=c.selectedCharacter,g=b.getCursor(),j=b.listSelections();if(e.visualMode)g=b.getCursor("start"),i=b.getCursor("end");else{var k=b.getLine(g.line);h=g.ch+c.repeat,h>k.length&&(h=k.length),i=d(g.line,h)}if("\n"==f)e.visualMode||b.replaceRange("",g,i),(a.commands.newlineAndIndentContinueComment||a.commands.newlineAndIndent)(b);else{var l=b.getRange(g,i);if(l=l.replace(/[^\n]/g,f),e.visualBlock){var m=new Array(b.getOption("tabSize")+1).join(" ");l=b.getSelection(),l=l.replace(/\t/g,m).replace(/[^\n]/g,f).split("\n"),b.replaceSelections(l)}else b.replaceRange(l,g,i);e.visualMode?(g=la(j[0].anchor,j[0].head)?j[0].anchor:j[0].head,b.setCursor(g),Ca(b,!1)):b.setCursor(da(i,0,-1))}},incrementNumberToken:function(a,b){for(var g,h,i,j,k,c=a.getCursor(),e=a.getLine(c.line),f=/-?\d+/g;null!==(g=f.exec(e))&&(k=g[0],h=g.index,i=h+k.length,!(c.ch<i)););if((b.backtrack||!(i<=c.ch))&&k){var l=b.increase?1:-1,m=parseInt(k)+l*b.repeat,n=d(c.line,h),o=d(c.line,i);j=m.toString(),a.replaceRange(j,n,o),a.setCursor(d(c.line,h+j.length-1))}},repeatLastEdit:function(a,b,c){var d=c.lastEditInputState;if(d){var e=b.repeat;e&&b.repeatIsExplicit?c.lastEditInputState.repeatOverride=e:e=c.lastEditInputState.repeatOverride||e,Hb(a,c,e,!1)}},exitInsertMode:ub},Ja={"(":"bracket",")":"bracket","{":"bracket","}":"bracket","[":"section","]":"section","*":"comment","/":"comment",m:"method",M:"method","#":"preprocess"},Ka={bracket:{isComplete:function(a){if(a.nextCh===a.symb){if(a.depth++,a.depth>=1)return!0}else a.nextCh===a.reverseSymb&&a.depth--;return!1}},section:{init:function(a){a.curMoveThrough=!0,a.symb=(a.forward?"]":"[")===a.symb?"{":"}"},isComplete:function(a){return 0===a.index&&a.nextCh===a.symb}},comment:{isComplete:function(a){var b="*"===a.lastCh&&"/"===a.nextCh;return a.lastCh=a.nextCh,b}},method:{init:function(a){a.symb="m"===a.symb?"{":"}",a.reverseSymb="{"===a.symb?"}":"{"},isComplete:function(a){return a.nextCh===a.symb?!0:!1}},preprocess:{init:function(a){a.index=0},isComplete:function(a){if("#"===a.nextCh){var b=a.lineText.match(/#(\w+)/)[1];if("endif"===b){if(a.forward&&0===a.depth)return!0;a.depth++}else if("if"===b){if(!a.forward&&0===a.depth)return!0;a.depth--}if("else"===b&&0===a.depth)return!0}return!1}}};E("pcre",!0,"boolean"),Va.prototype={getQuery:function(){return L.query},setQuery:function(a){L.query=a},getOverlay:function(){return this.searchOverlay},setOverlay:function(a){this.searchOverlay=a},isReversed:function(){return L.isReversed},setReversed:function(a){L.isReversed=a},getScrollbarAnnotate:function(){return this.annotate},setScrollbarAnnotate:function(a){this.annotate=a}};var _a={"\\n":"\n","\\r":"\r","\\t":"	"},bb={"\\/":"/","\\\\":"\\","\\n":"\n","\\r":"\r","\\t":"	"},gb="(Javascript regexp)",qb=function(){this.buildCommandMap_()};qb.prototype={processCommand:function(a,b,c){var d=this;a.operation(function(){a.curOp.isVimOp=!0,d._processCommand(a,b,c)})},_processCommand:function(b,c,d){var e=b.state.vim,f=L.registerController.getRegister(":"),g=f.toString();e.visualMode&&Ca(b);var h=new a.StringStream(c);f.setText(c);var i=d||{};i.input=c;try{this.parseInput_(b,h,i)}catch(j){throw eb(b,j),j}var k,l;if(i.commandName){if(k=this.matchCommand_(i.commandName)){if(l=k.name,k.excludeFromCommandHistory&&f.setText(g),this.parseCommandArgs_(h,i,k),"exToKey"==k.type){for(var m=0;m<k.toKeys.length;m++)a.Vim.handleKey(b,k.toKeys[m],"mapping");return}if("exToEx"==k.type)return void this.processCommand(b,k.toInput)}}else void 0!==i.line&&(l="move");if(!l)return void eb(b,'Not an editor command ":'+c+'"');try{rb[l](b,i),k&&k.possiblyAsync||!i.callback||i.callback()}catch(j){throw eb(b,j),j}},parseInput_:function(a,b,c){b.eatWhile(":"),b.eat("%")?(c.line=a.firstLine(),c.lineEnd=a.lastLine()):(c.line=this.parseLineSpec_(a,b),void 0!==c.line&&b.eat(",")&&(c.lineEnd=this.parseLineSpec_(a,b)));var d=b.match(/^(\w+)/);return d?c.commandName=d[1]:c.commandName=b.match(/.*/)[0],c},parseLineSpec_:function(a,b){var c=b.match(/^(\d+)/);if(c)return parseInt(c[1],10)-1;switch(b.next()){case".":return a.getCursor().line;case"$":return a.lastLine();case"'":var d=a.state.vim.marks[b.next()];if(d&&d.find())return d.find().line;throw new Error("Mark not set");default:return void b.backUp(1)}},parseCommandArgs_:function(a,b,c){if(!a.eol()){b.argString=a.match(/.*/)[0];var d=c.argDelimiter||/\s+/,e=qa(b.argString).split(d);e.length&&e[0]&&(b.args=e)}},matchCommand_:function(a){for(var b=a.length;b>0;b--){var c=a.substring(0,b);if(this.commandMap_[c]){var d=this.commandMap_[c];if(0===d.name.indexOf(a))return d}}return null},buildCommandMap_:function(){this.commandMap_={};for(var a=0;a<c.length;a++){var b=c[a],d=b.shortName||b.name;this.commandMap_[d]=b}},map:function(a,c,d){if(":"!=a&&":"==a.charAt(0)){if(d)throw Error("Mode not supported for ex mappings");var e=a.substring(1);":"!=c&&":"==c.charAt(0)?this.commandMap_[e]={name:e,type:"exToEx",toInput:c.substring(1),user:!0}:this.commandMap_[e]={name:e,type:"exToKey",toKeys:c,user:!0}}else if(":"!=c&&":"==c.charAt(0)){var f={keys:a,type:"keyToEx",exArgs:{input:c.substring(1)},user:!0};d&&(f.context=d),b.unshift(f)}else{var f={keys:a,type:"keyToKey",toKeys:c,user:!0};d&&(f.context=d),b.unshift(f)}},unmap:function(a,c){if(":"!=a&&":"==a.charAt(0)){if(c)throw Error("Mode not supported for ex mappings");var d=a.substring(1);if(this.commandMap_[d]&&this.commandMap_[d].user)return void delete this.commandMap_[d]}else for(var e=a,f=0;f<b.length;f++)if(e==b[f].keys&&b[f].context===c&&b[f].user)return void b.splice(f,1);throw Error("No such mapping.")}};var rb={colorscheme:function(a,b){return!b.args||b.args.length<1?void eb(a,a.getOption("theme")):void a.setOption("theme",b.args[0])},map:function(a,b,c){var d=b.args;return!d||d.length<2?void(a&&eb(a,"Invalid mapping: "+b.input)):void sb.map(d[0],d[1],c)},imap:function(a,b){this.map(a,b,"insert")},nmap:function(a,b){this.map(a,b,"normal")},vmap:function(a,b){this.map(a,b,"visual")},unmap:function(a,b,c){var d=b.args;return!d||d.length<1?void(a&&eb(a,"No such mapping: "+b.input)):void sb.unmap(d[0],c)},move:function(a,b){V.processCommand(a,a.state.vim,{type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!1,explicitRepeat:!0,linewise:!0},repeatOverride:b.line+1})},set:function(a,b){var c=b.args,d=b.setCfg||{};if(!c||c.length<1)return void(a&&eb(a,"Invalid mapping: "+b.input));var e=c[0].split("="),f=e[0],g=e[1],h=!1;if("?"==f.charAt(f.length-1)){if(g)throw Error("Trailing characters: "+b.argString);f=f.substring(0,f.length-1),h=!0}void 0===g&&"no"==f.substring(0,2)&&(f=f.substring(2),g=!1);var i=D[f]&&"boolean"==D[f].type;if(i&&void 0==g&&(g=!0),!i&&void 0===g||h){var j=G(f,a,d);j===!0||j===!1?eb(a," "+(j?"":"no")+f):eb(a,"  "+f+"="+j)}else F(f,g,a,d)},setlocal:function(a,b){b.setCfg={scope:"local"},this.set(a,b)},setglobal:function(a,b){b.setCfg={scope:"global"},this.set(a,b)},registers:function(a,b){var c=b.args,d=L.registerController.registers,e="----------Registers----------<br><br>";if(c){var f;c=c.join("");for(var h=0;h<c.length;h++)if(f=c.charAt(h),L.registerController.isValidRegister(f)){var i=d[f]||new R;e+='"'+f+"    "+i.toString()+"<br>"}}else for(var f in d){var g=d[f].toString();g.length&&(e+='"'+f+"    "+g+"<br>")}eb(a,e)},sort:function(b,c){function i(){if(c.argString){var b=new a.StringStream(c.argString);if(b.eat("!")&&(e=!0),b.eol())return;if(!b.eatSpace())return"Invalid arguments";var d=b.match(/[a-z]+/);if(d){d=d[0],f=-1!=d.indexOf("i"),g=-1!=d.indexOf("u");var i=-1!=d.indexOf("d")&&1,j=-1!=d.indexOf("x")&&1,k=-1!=d.indexOf("o")&&1;if(i+j+k>1)return"Invalid arguments";h=i&&"decimal"||j&&"hex"||k&&"octal"}if(b.match(/\/.*\//))return"patterns not supported"}}function u(a,b){if(e){var c;c=a,a=b,b=c}f&&(a=a.toLowerCase(),b=b.toLowerCase());var d=h&&p.exec(a),g=h&&p.exec(b);return d?(d=parseInt((d[1]+d[2]).toLowerCase(),q),g=parseInt((g[1]+g[2]).toLowerCase(),q),d-g):b>a?-1:1}var e,f,g,h,j=i();if(j)return void eb(b,j+": "+c.argString);var k=c.line||b.firstLine(),l=c.lineEnd||c.line||b.lastLine();if(k!=l){var m=d(k,0),n=d(l,pa(b,l)),o=b.getRange(m,n).split("\n"),p="decimal"==h?/(-?)([\d]+)/:"hex"==h?/(-?)(?:0x)?([0-9a-f]+)/i:"octal"==h?/([0-7]+)/:null,q="decimal"==h?10:"hex"==h?16:"octal"==h?8:null,r=[],s=[];if(h)for(var t=0;t<o.length;t++)p.exec(o[t])?r.push(o[t]):s.push(o[t]);else s=o;if(r.sort(u),s.sort(u),o=e?r.concat(s):s.concat(r),g){var w,v=o;o=[];for(var t=0;t<v.length;t++)v[t]!=w&&o.push(v[t]),w=v[t]}b.replaceRange(o.join("\n"),m,n)}},global:function(a,b){var c=b.argString;if(!c)return void eb(a,"Regular Expression missing from global");var h,d=void 0!==b.line?b.line:a.firstLine(),e=b.lineEnd||b.line||a.lastLine(),f=Ya(c),g=c;if(f.length&&(g=f[0],h=f.slice(1,f.length).join("/")),g)try{jb(a,g,!0,!0)}catch(i){return void eb(a,"Invalid regex: "+g)}for(var j=Wa(a).getQuery(),k=[],l="",m=d;e>=m;m++){var n=j.test(a.getLine(m));n&&(k.push(m+1),l+=a.getLine(m)+"<br>")}if(!h)return void eb(a,l);var o=0,p=function(){if(o<k.length){var b=k[o]+h;sb.processCommand(a,b,{callback:p})}o++};p()},substitute:function(a,b){if(!a.getSearchCursor)throw new Error("Search feature not available. Requires searchcursor.js or any other getSearchCursor implementation.");var f,h,i,j,c=b.argString,e=c?Ya(c):[],g="",k=!1,l=!1;if(e.length)f=e[0],g=e[1],void 0!==g&&(g=G("pcre")?cb(g):ab(g),L.lastSubstituteReplacePart=g),h=e[2]?e[2].split(" "):[];else if(c&&c.length)return void eb(a,"Substitutions should be of the form :s/pattern/replace/");if(h&&(i=h[0],j=parseInt(h[1]),i&&(-1!=i.indexOf("c")&&(k=!0,i.replace("c","")),-1!=i.indexOf("g")&&(l=!0,i.replace("g","")),f=f+"/"+i)),f)try{jb(a,f,!0,!0)}catch(m){return void eb(a,"Invalid regex: "+f)}if(g=g||L.lastSubstituteReplacePart,void 0===g)return void eb(a,"No previous substitute regular expression");var n=Wa(a),o=n.getQuery(),p=void 0!==b.line?b.line:a.getCursor().line,q=b.lineEnd||p;p==a.firstLine()&&q==a.lastLine()&&(q=1/0),j&&(p=q,q=p+j-1);var r=ba(a,d(p,0)),s=a.getSearchCursor(o,r);tb(a,k,l,p,q,s,o,g,b.callback)},redo:a.commands.redo,undo:a.commands.undo,write:function(b){a.commands.save?a.commands.save(b):b.save&&b.save()},nohlsearch:function(a){nb(a)},yank:function(a){var b=ja(a.getCursor()),c=b.line,d=a.getLine(c);L.registerController.pushText("0","yank",d,!0,!0)},delmarks:function(b,c){if(!c.argString||!qa(c.argString))return void eb(b,"Argument required");for(var d=b.state.vim,e=new a.StringStream(qa(c.argString));!e.eol();){e.eatSpace();var f=e.pos;if(!e.match(/[a-zA-Z]/,!1))return void eb(b,"Invalid argument: "+c.argString.substring(f));var g=e.next();if(e.match("-",!0)){if(!e.match(/[a-zA-Z]/,!1))return void eb(b,"Invalid argument: "+c.argString.substring(f));var h=g,i=e.next();if(!(x(h)&&x(i)||A(h)&&A(i)))return void eb(b,"Invalid argument: "+h+"-");var j=h.charCodeAt(0),k=i.charCodeAt(0);if(j>=k)return void eb(b,"Invalid argument: "+c.argString.substring(f));for(var l=0;k-j>=l;l++){var m=String.fromCharCode(j+l);delete d.marks[m]}}else delete d.marks[g]}}},sb=new qb;return a.keyMap.vim={attach:h,detach:g,call:i},E("insertModeEscKeysTimeout",200,"number"),a.keyMap["vim-insert"]={"Ctrl-N":"autocomplete","Ctrl-P":"autocomplete",Enter:function(b){var c=a.commands.newlineAndIndentContinueComment||a.commands.newlineAndIndent;c(b)},fallthrough:["default"],attach:h,detach:g,call:i},a.keyMap["vim-replace"]={Backspace:"goCharLeft",fallthrough:["vim-insert"],attach:h,detach:g,call:i},M(),O};a.Vim=e()});